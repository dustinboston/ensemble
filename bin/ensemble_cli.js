var Ls=Object.defineProperty;var Fs=(e,t)=>{for(var o in t)Ls(e,o,{get:t[o],enumerable:!0})};import*as xs from"qjs:os";import*as pe from"qjs:std";var M={};Fs(M,{AtomNode:()=>Me,BooleanNode:()=>Te,DomNode:()=>De,ErrorNode:()=>Ae,FunctionNode:()=>Ve,KeywordNode:()=>Pe,ListNode:()=>fe,MapNode:()=>Le,NilNode:()=>Fe,NumberNode:()=>ee,StringNode:()=>de,SymbolNode:()=>ie,VectorNode:()=>he,append:()=>_s,assertArgumentCount:()=>s,assertAstNode:()=>m,assertAtomNode:()=>W,assertBooleanNode:()=>Rs,assertDefined:()=>ke,assertDomNode:()=>ks,assertEq:()=>Us,assertEqual:()=>mt,assertErrorNode:()=>Ie,assertEvenArgumentCount:()=>ve,assertFunctionNode:()=>w,assertGreaterThanEqual:()=>js,assertIsOneOf:()=>Gs,assertKeywordNode:()=>Bs,assertListNode:()=>j,assertMapKeyNode:()=>O,assertMapNode:()=>U,assertMetadataType:()=>_e,assertMinimumArgumentCount:()=>E,assertNilNode:()=>tt,assertNullOrUndefined:()=>Ks,assertNumberNode:()=>p,assertRegExp:()=>re,assertSequential:()=>J,assertSequentialValues:()=>Y,assertStringNode:()=>d,assertSymWithValue:()=>Ne,assertSymbol:()=>ot,assertSymbolNode:()=>q,assertTrue:()=>Os,assertUndefined:()=>qs,assertVariableArgumentCount:()=>f,assertVectorNode:()=>h,continueResult:()=>Se,convertMapKeyToString:()=>Z,convertStringToMapKey:()=>st,copy:()=>G,copyAtomNode:()=>At,copyBooleanNode:()=>ft,copyDomNode:()=>gt,copyErrorNode:()=>vt,copyFunctionNode:()=>xt,copyKeywordNode:()=>bt,copyListNode:()=>Ct,copyMapNode:()=>ht,copyNilNode:()=>St,copyNumberNode:()=>Et,copyStringNode:()=>wt,copySymbolNode:()=>Mt,copyVectorNode:()=>Tt,createAtomNode:()=>oe,createBooleanNode:()=>c,createDomNode:()=>ge,createErrorNode:()=>I,createFunctionNode:()=>F,createKeywordNode:()=>le,createListNode:()=>b,createMapNode:()=>T,createNilNode:()=>r,createNumberNode:()=>i,createStringNode:()=>N,createSymbolNode:()=>x,createVectorNode:()=>A,deleteMapElement:()=>Ue,getBareMapKey:()=>Ee,getMapElement:()=>Ke,getMapKeys:()=>Oe,getMapValues:()=>Hs,hasMapElement:()=>qe,htmlEncode:()=>zs,isAstNode:()=>$,isAstTruthy:()=>Re,isAtomNode:()=>se,isBooleanNode:()=>X,isDefined:()=>Ce,isDomNode:()=>ne,isEqualTo:()=>te,isErrorNode:()=>z,isFunctionNode:()=>K,isKeywordNode:()=>_,isListNode:()=>D,isMapKeyNode:()=>ct,isMapNode:()=>C,isNilNode:()=>V,isNumberNode:()=>g,isSameClass:()=>Nt,isSequentialNode:()=>B,isStringNode:()=>S,isSymbolNode:()=>k,isTypedVector:()=>Ws,isVectorNode:()=>L,listStartsWithSymbol:()=>He,mapFlat:()=>Qe,normalizeWhitespace:()=>Js,prepend:()=>$s,returnResult:()=>ye,setMapElement:()=>Be,slash:()=>Ge,splitAtFirstDot:()=>Qs,toAst:()=>y,toErrorNode:()=>Xs,unwrap:()=>H,unwrapAtomNode:()=>Dt,unwrapBooleanNode:()=>Vt,unwrapDomNode:()=>Ys,unwrapErrorNode:()=>Pt,unwrapFunctionNode:()=>Lt,unwrapKeywordNode:()=>Ft,unwrapListNode:()=>It,unwrapMapNode:()=>We,unwrapNilNode:()=>kt,unwrapNumberNode:()=>ae,unwrapStringNode:()=>xe,unwrapSymbolNode:()=>Rt,unwrapVectorNode:()=>Bt});var Me=class{constructor(t){this.value=t}kind="AtomNode"},Te=class{constructor(t){this.value=t}kind="BooleanNode"},De=class{constructor(t,o=new Map,n=[],u){this.value=t;this.attributes=o;this.children=n;this.metadata=u}kind="DomNode"},Is=["Error","AggregateError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],Ae=class e{constructor(t,o,n=r()){this.value=t;o!==void 0&&e.isErrorName(o)&&(this.name=o),n!==void 0&&(this.cause=n)}kind="ErrorNode";name=N("Error");cause;static isErrorName(t){let o=t.value;return Is.includes(o)}static assertErrorName(t){if(!e.isErrorName(t))throw new TypeError("Error type must be 'Error', 'AggregateError', 'RangeError', 'ReferenceError', 'SyntaxError', 'TypeError', or 'URIError'.")}},Ve=class{constructor(t,o,n=!1,u){this.value=t;this.closureMeta=o;this.isMacro=n;this.metadata=u}kind="FunctionNode"},Pe=class{constructor(t){this._value=t;this._value=t.replaceAll(":","")}kind="KeywordNode";get value(){return`${this._value}:`}set value(t){this._value=`${t.replaceAll(":","")}:`}get bare(){return this._value}},fe=class{constructor(t,o){this.value=t;this.metadata=o}kind="ListNode"},Le=class{constructor(t=new Map,o){this.value=t;this.metadata=o}kind="MapNode"},Fe=class{constructor(t=null){this.value=t}kind="NilNode"},ee=class{constructor(t){this.value=t}kind="NumberNode"},ie=class{constructor(t){this.value=t}kind="SymbolNode"},de=class{constructor(t){this.value=t}kind="StringNode"},he=class{constructor(t,o){this.value=t;this.metadata=o}kind="VectorNode"};function ks(e){if(!ne(e))throw new TypeError("Invalid DomNode")}function m(e){if(!$(e))throw new TypeError("Invalid AstNode")}function W(e){if(!se(e))throw new TypeError("Invalid AtomNode")}function Rs(e){if(!X(e))throw new TypeError("Invalid BooleanNode")}function U(e){if(!C(e))throw new TypeError("Invalid MapNode")}function Ie(e){if(!z(e))throw new TypeError("Invalid ErrorNode")}function w(e){if(!K(e))throw new TypeError("Invalid FunctionNode")}function Bs(e){if(!_(e))throw new TypeError("Invalid KeywordNode")}function j(e){if(!D(e))throw new TypeError("Invalid ListNode")}function tt(e){if(!V(e))throw new TypeError("Invalid NilNode")}function p(e){if(!g(e))throw new TypeError("Invalid NumberNode")}function d(e){if(!S(e))throw new TypeError("Invalid StringNode")}function q(e){if(!k(e))throw new TypeError("Invalid SymbolNode")}function h(e){if(!L(e))throw new TypeError("Invalid VectorNode")}function re(e){if(!(e instanceof RegExp))throw new Error("Expected a RegExp object.")}function ot(e){if(typeof e!="symbol")throw new Error("Expected a Symbol object.")}function ge(e,t,o,n){return new De(e,t,o,n)}function oe(e){return new Me(e)}function c(e){return new Te(e)}function T(e,t){return new Le(e,t)}function I(e,t,o){return m(e),new Ae(e,t,o)}function F(e,t,o,n){return new Ve(e,t,o,n)}function le(e){return new Pe(e)}function b(e,t){return new fe(e,t)}function r(e){return new Fe(e)}function i(e){return new ee(e)}function N(e){return new de(e)}function x(e){return new ie(e)}function A(e=[],t){return new he(e,t)}function ne(e){return e instanceof De}function $(e){return se(e)||X(e)||ne(e)||z(e)||K(e)||_(e)||D(e)||C(e)||V(e)||g(e)||S(e)||k(e)||L(e)}function se(e){return e instanceof Me}function X(e){return e instanceof Te&&typeof e.value=="boolean"}function C(e){return e instanceof Le&&e.value instanceof Map}function z(e){return e instanceof Ae&&$(e.value)}function K(e){return e instanceof Ve&&typeof e.value=="function"}function _(e){return e instanceof Pe&&typeof e.value=="string"&&e.value.endsWith(":")}function D(e){return e instanceof fe&&e.value.every($)}function V(e){return e instanceof Fe&&e.value===null}function g(e){return e instanceof ee&&typeof e.value=="number"}function S(e){return e instanceof de&&typeof e.value=="string"}function k(e){return e instanceof ie&&typeof e.value=="string"}function L(e){return e instanceof he&&e.value.every($)}function Nt(e,t){return Object.getPrototypeOf(e)===Object.getPrototypeOf(t)}function Us(e,t){if(!te(e,t))throw new Error("Values are not equal")}function ke(e){if(e===void 0)throw new Error("Value is undefined")}function qs(e){if(e!==void 0)throw new Error("Value is not undefined")}function Ks(e){if(e!=null)throw new Error("Value is not null or undefined")}function Ce(e){return e!==void 0}function Os(e){if(e===!1)throw new Error("Value is not true")}function Re(e,t=!1){if(X(e))return e.value;let o=e;return se(o)?$(o.value)?Re(o.value):!!o.value:V(e)?!1:g(e)?t?!!e.value:!0:!!e.value}function B(e){return D(e)||L(e)}function J(e){if(!D(e)&&!L(e))throw new TypeError("Invalid sequential type")}function O(e){if(!(S(e)||k(e)||_(e)))throw new TypeError("Invalid dictionary key")}function ct(e){return S(e)||k(e)||_(e)}function _e(e){if(!K(e)&&!D(e)&&!L(e)&&!C(e)&&!ne(e))throw new TypeError("Invalid metadata type")}function s(e,t,o){if(e!==t){let n=`Wanted ${t} arguments but got ${e}`;throw o&&(n+=` ${o}`),new Error(n)}}function f(e,t,o){if(e<t||e>o)throw new Error("Unexpected number of arguments")}function E(e,t){if(e<t)throw new Error("Unexpected minimum number of arguments")}function ve(e){if(e%2!==0)throw new Error("Uneven number of arguments")}function Y(e,t){for(let o of e)if(!(o instanceof t))throw new TypeError("All values must be of the same type")}function Gs(e,t){if(!t.some(o=>e instanceof o))throw new TypeError("Invalid type")}function Ws(e,t){return e.value.every(o=>o instanceof t)}function te(e,t){if(B(e)&&B(t)){if(e.value.length!==t.value.length)return c(!1);for(let n=0;n<e.value.length;n++)if(!te(e.value[n],t.value[n]).value)return c(!1);return c(!0)}if(C(e)&&C(t)){if(e.value.size!==t.value.size)return c(!1);for(let[n,u]of e.value){let a=t.value.get(n);if(a===void 0||!te(u,a).value)return c(!1)}return c(!0)}if(!Nt(e,t))return c(!1);let o=e.value===t.value;return c(o)}function He(e,t){let o=D(e)&&k(e.value[0]);return o&&t!==void 0?e.value[0].value===t:o}function mt(e,t){if(e!==t)throw new Error(`Unexpected value '${e}', wanted ${t}`)}function js(e,t){if(e>=t)throw new Error("Unexpected value")}function Ne(e,t){mt(e.value,t)}function Se(e,t){return{continue:{ast:e,env:t},return:void 0}}function ye(e){return{continue:void 0,return:e}}var $s=(e,t)=>[t,...e],_s=(e,t)=>[...e,t];function G(e){if(se(e))return At(e);if(X(e))return ft(e);if(C(e))return ht(e);if(z(e))return vt(e);if(K(e))return xt(e);if(_(e))return bt(e);if(D(e))return Ct(e);if(V(e))return St(e);if(g(e))return Et(e);if(S(e))return wt(e);if(k(e))return Mt(e);if(L(e))return Tt(e);if(ne(e))return gt(e);throw new Error("Unmatched object")}function At(e){return oe(G(e.value))}function ft(e){return c(e.value)}function ht(e){let t=T(new Map(e.value));return t.metadata=G(e.metadata??r()),t}function gt(e){let t=e.value,o=e.attributes,n=e.children,u=ge(t,new Map(o),n.map(G));return u.metadata=G(e.metadata??r()),u}function vt(e){return I(G(e.value))}function xt(e){let t=F(e.value);if(t.isMacro=e.isMacro,t.metadata=G(e.metadata??r()),e.closureMeta){let o=e.closureMeta;t.closureMeta={ast:G(o.ast),env:o.env,parameters:o.parameters.map(n=>x(n.value))}}return t}function bt(e){return le(e.value)}function Ct(e){let t=b(e.value.map(o=>G(o)));return t.metadata=G(e.metadata??r()),t}function St(e){return r()}function Et(e){return i(e.value)}function wt(e){return N(e.value)}function Mt(e){return x(e.value)}function Tt(e){let t=A(e.value.map(o=>G(o)));return t.metadata=G(e.metadata??r()),t}function Be(e,t,o){e.set(Z(t),o)}function Ue(e,t){e.delete(Z(t))}function qe(e,t){return e.has(Z(t))}function Ke(e,t){return e.get(Z(t))}function Oe(e){let t=[...e.keys()];return b(t.map(o=>st(o)))}function Z(e){let t=e;if(_(t))return t.value;let o=e;return S(o)?`"${o.value}"`:e.value}function st(e){return e.endsWith(":")?le(e):e.startsWith('"')?N(e.slice(1,-1)):x(e)}function Ee(e){let t=ct(e)?e.value:e;return t.startsWith(":")||t.endsWith(":")?t.replaceAll(":",""):t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t}function Hs(e){let t=[...e.values()];return b(t)}function Qe(e){let t=[];for(let[o,n]of e.entries())t.push(st(o),n);return t}function Qs(e){let t=e.indexOf(".");return[e.slice(0,t),e.slice(t+1)]}function zs(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&apos;")}function Js(e){return e.replaceAll(`
`," ").replaceAll(/\s{2,}/g," ")}function Ge(e){return e.replaceAll("\\","\\\\").replaceAll('"','\\"').replaceAll(`
`,"\\n")}function H(e){if(se(e))return Dt(e);if(X(e))return Vt(e);if(C(e))return We(e);if(z(e))return Pt(e);if(K(e))return Lt(e);if(_(e))return Ft(e);if(D(e))return It(e);if(V(e))return kt();if(g(e))return ae(e);if(S(e))return xe(e);if(k(e))return Rt(e);if(L(e))return Bt(e);throw new Error("Could not unwrap object.")}function Dt(e){return H(e.value)}function Vt(e){return e.value}function Ys(e){return e.value}function Pt(e){let t=S(e.value)?e.value.value:String(H(e.value));return new Error(t)}function Lt(e){return(...t)=>y(H(e.value(...t)))}function Ft(e){return e.value}function It(e){return e.value.map(H)}function We(e){let t={};for(let[o,n]of e.value.entries())t[o]=H(n);return t}function kt(){return null}function ae(e){return e.value}function xe(e){return e.value}function Rt(e){return e.value}function Bt(e){return e.value.map(H)}function y(e){if($(e))return e;switch(typeof e){case"undefined":return r();case"number":return i(e);case"string":return e.startsWith('"')?N(e):e.startsWith(":")?le(e):x(e);case"boolean":return c(e);case"symbol":return N(JSON.stringify(e));case"function":return F((...t)=>{try{return y(e(...t.map(o=>o.value)))}catch(o){return o instanceof Error?I(N(o.message)):I(N(JSON.stringify(o)))}});case"object":{if(e instanceof Error)return I(N(e.message));if(e===null)return r();if(Array.isArray(e)){let n=e.map(u=>y(u));return b(n)}if(e instanceof Map){let n=new Map;for(let[u,a]of e.entries()){let l=String(u),v=y(a);n.set(l,v)}return T(n)}let t=e,o=new Map;for(let[n,u]of Object.entries(t)){let a=String(n),l=y(u);o.set(a,l)}return T(o)}default:{let t=String(e);return I(N(`unknown type ${t}`))}}}function Xs(e){return z(e)?e:$(e)?I(e):e instanceof Error?I(N(e.message)):I(N(String(e)))}var ue=class{value=new Map;outer;binds=[];exprs=[];constructor(t=void 0,o=[],n=[]){this.outer=t,this.binds=o,this.exprs=n;for(let u=0;u<o.length;u++){let a=o[u];if(a.value==="&"){let v=o[u+1];if(v){let P=n.slice(u),Ps=Z(v);this.value.set(Ps,b(P));break}}let l=Z(a);this.value.set(l,n[u])}}serialize(){let t=T(),o=T();this.outer&&(o=this.outer.serialize());let n=this.value.entries();for(let[u,a]of n)t.value.set(u,a);return t.value.set("__outer__",o),t}set(t,o){let n=Z(t);return this.value.set(n,o),o}findEnv(t){let o=Z(t);if(this.value.has(o))return this;if(Ce(this.outer))return this.outer.findEnv(t)}get(t){let o=this.findEnv(t);if(o===void 0)throw new Error(`'${t.value}' not found`);let n=Z(t),u=o.value.get(n);return ke(u),u}};function R(e,t=!1){if(S(e))return t?`"${Ge(e.value)}"`:e.value;if(_(e)||X(e)||g(e)||k(e))return String(e.value);let o=e;if(se(o))return`(atom ${R(o.value)})`;if(z(e))return R(e.value,t);if(K(e))return"#<fn>";if(B(e)){let n=D(e),u=e.value.map(a=>R(a,t)).join(" ");return n?`(${u})`:`[${u}]`}if(ne(e))return be(e,t);if(C(e))return`{${Qe(e.value).map(u=>R(u,t)).join(" ")}}`;if(V(e))return"nil";throw new Error(`unmatched object ${JSON.stringify(e)}`)}var Zs=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]);function be(e,t=!1){if(ne(e)){let n=e.value,u=Zs.has(n),a="";if(e.attributes.size>0&&(a=` ${Array.from(e.attributes).map(([v,P])=>v==="style"?on(P,t):`${Ee(v)}="${be(P,t)}"`).join(" ")}`),u)return`<${n}${a} />`;let l=[];if(e.children.length>0){let v=[];n==="style"?v=e.children.map(P=>tn(P,t)):n==="script"?v=e.children.map(P=>en(P,t)):v=e.children.map(P=>be(P,t)),l.push(v.join(" "))}return n==="!doctype"?`<!doctype html>
${l.join(" ")}`:`<${n}${a}>${l.join(" ")}</${n}>`}if(S(e))return t?`"${Ge(e.value)}"`:e.value;if(_(e)||X(e)||g(e)||k(e))return String(e.value);let o=e;if(se(o))return`(atom ${be(o.value)})`;if(z(e))return be(e.value,t);if(K(e))return"#<fn>";if(B(e)){let n=D(e),u=e.value.map(a=>be(a,t)).join(" ");return n?`(${u})`:`[${u}]`}if(C(e))return`{${Qe(e.value).map(u=>be(u,t)).join(" ")}}`;if(V(e))return"nil";throw new Error(`unmatched object ${JSON.stringify(e)}`)}function en(e,t=!1){return`
	import { rep, initEnv } from '../../bin/ensemble.js';
	rep(\`${R(e,!0)}\`, initEnv());	
	`}function we(e,t=!1){if(S(e))return t?Ge(e.value):e.value;if(_(e))return e.value.slice(1);if(g(e))return String(e.value);if(k(e))return e.value;if(z(e))return we(e.value,t);if(D(e)||L(e))return e.value.map(o=>we(o,t)).join(" ");if(C(e))return[...e.value].map(([o,n])=>{let u=Ee(o);return V(n)?u:C(n)?`${u} {${we(n,t)}}`:`${Ee(o)}: ${we(n,t)};`}).join(" ");if(X(e)||se(e)||K(e)||ne(e)||V(e))return"";throw new Error("unmatched object")}function tn(e,t=!1){return we(e,t)}function on(e,t=!1){return C(e)?sn(e,t):"{}"}function sn(e,t=!1){return[...e.value].map(([o,n])=>`${Ee(o)}: ${we(n,t)};`).join("")}var nn=/[\s,=]*(~@|[[\]{}()'`~^@<>]|"(?:\\.|[^\\"])*"?|;.*|\/\/.*|\r?\n|[^\s[\]{}<>('"`,;=)]*)/g,rn=/^-?\d+(\.\d+)?$/,un=/"(?:\\.|[^\\"])*"/,nt=class{constructor(t,o=0){this.tokens=t;this.pos=o}line=0;next=()=>this.tokens[this.pos++];peek=()=>this.tokens[this.pos];context=()=>{let t=this.pos-10,o=this.pos+10;return this.tokens.slice(t,o).join(" ")}};function Ye(e,t){let o=e instanceof Error?e.message:e,n=t.context();return`Error: ${o}
  on line ${t.line} near "${n}"`}function pn(e){return[...e.matchAll(nn)].filter(o=>!o[1].startsWith(";")&&!o[1].startsWith("//")&&o[1]!=="").map(o=>o[1])}function Xe(e){try{let t=pn(e);return t.length===0?r():je(new nt(t))}catch(t){let o=t instanceof Error?t.message:String(t);return console.log(`Error reading input: ${o}`),r()}}function je(e){let t=e.peek();if(t===void 0)throw new Error("EOF");function o(n,u){return b([x(n),je(e),...u?[u]:[]])}switch(t){case`
`:case`\r
`:return e.line++,e.next(),je(e);case"'":return e.next(),o("quote");case"`":return e.next(),o("quasiquote");case"~":return e.next(),o("unquote");case"~@":return e.next(),o("splice-unquote");case"^":{e.next();let n=je(e);return o("with-meta",n)}case"@":return e.next(),o("deref");case")":case"]":case"}":case">":{let n=Ye(`unexpected '${t}'`,e);throw new Error(n)}case"(":return Je(e,")");case"[":return Je(e,"]");case"{":return Je(e,"}");case"<":return Je(e,">");default:return yn(e)}}function yn(e){let t=e.next();if(t===void 0)throw new Error("unexpected EOF");if(t==="nil")return r();if(t==="false")return c(!1);if(t==="true")return c(!0);if(rn.test(t))return i(Number.parseFloat(t));if(un.test(t))return N(an(t));if(t.startsWith(":")||t.endsWith(":"))return le(t);if(t.startsWith('"')){let o=Ye(`expected '"', got EOF`,e);throw new Error(o)}return x(t)}function an(e){return e.slice(1,-1).replaceAll(/\\(.)/g,(t,o)=>o==="n"?`
`:o)}function Je(e,t){let o=[];for(e.next();;){let n=e.peek();if(n===void 0){let u=Ye(`expected '${t}', got EOF`,e);throw new Error(u)}if(n===t){e.next();break}o.push(je(e))}switch(t){case">":case")":return b(o);case"]":return A(o);case"}":{let n=T();for(let u=0;u<o.length;u+=2){let a=o[u];O(a);let l=o[u+1],v=Z(a);n.value.set(v,l)}return n}default:{let n=Ye(`unknown end value: ${t}`,e);throw new Error(n)}}}var Kt=new Map,Ot=[["eq",Gt],["throw",vo],["nil?",Mo],["true?",To],["false?",Do],["symbol",ut],["Symbol.new",ut],["symbol?",Po],["keyword",Lo],["keyword?",Fo],["number?",Io],["macro?",Ro],["pr-str",Wt],["str",jt],["prn",$t],["println",rt],["console.log",rt],["read-string",_t],["string?",Vo],["trim",Ht],["lt",Qt],["lte",zt],["gt",Jt],["gte",Yt],["add",Xt],["subtract",Zt],["multiply",eo],["divide",to],["time-ms",oo],["assoc",Ko],["contains?",Wo],["dissoc",Oo],["get",Go],["hash-map",pt],["keys",jo],["map?",qo],["vals",$o],["list",so],["list?",no],["apply",xo],["fn?",ko],["concat",uo],["conj",Co],["cons",ro],["count",co],["empty?",No],["first",ao],["last",io],["join",Ho],["map",bo],["nth",yo],["rest",lo],["seq",So],["sequential?",_o],["vec",po],["vector",Bo],["vector?",Uo],["meta",Eo],["with-meta",wo],["atom",mo],["atom?",Ao],["deref",fo],["reset!",ho],["swap!",go],[".",ln]];for(let[e,t]of Ot)Kt.set(x(e),F(t));function Gt(...e){return s(e.length,2),te(e[0],e[1])}function Wt(...e){let t=e.map(o=>R(o,!0)).join(" ");return N(t)}function jt(...e){let t=e.map(o=>R(o,!1)).join("");return N(t)}function $t(...e){let t=e.map(o=>R(o,!0)).join(" ");return console.log(t),r()}function rt(...e){let t=e.map(o=>R(o,!1)).join(" ");return console.log(t),r()}function _t(...e){s(e.length,1);let t=e[0];return d(t),Xe(t.value)}function Ht(...e){s(e.length,1);let t=e[0];return d(t),N(t.value.trim())}function Qt(...e){s(e.length,2,`
args: ${JSON.stringify(e,null,"  ")}`);let t=e[0];p(t);let o=e[1];return p(o),c(t.value<o.value)}function zt(...e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),c(t.value<=o.value)}function Jt(...e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),c(t.value>o.value)}function Yt(...e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),c(t.value>=o.value)}function Xt(...e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),i(t.value+o.value)}function Zt(...e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),i(t.value-o.value)}function eo(...e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),i(t.value*o.value)}function to(...e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),i(t.value/o.value)}function oo(...e){return s(e.length,0),i(new Date().getTime())}function so(...e){for(let t of e)m(t);return b(e)}function no(...e){return s(e.length,1),c(D(e[0]))}function ro(...e){return s(e.length,2),J(e[1]),new fe([e[0],...e[1].value])}function uo(...e){let t=[];for(let o of e)J(o),t.push(...o.value);return b(t)}function po(...e){return D(e[0])?A(e[0].value):e[0]}function yo(...e){if(s(e.length,2),B(e[0])&&g(e[1])){let t=e[1].value,o=e[0],n=e[0].value.length;if(n>0&&t<n)return o.value[t]}throw new Error("out of range")}function ao(...e){return s(e.length,1),B(e[0])&&e[0].value.length>0?e[0].value[0]:r()}function io(...e){return s(e.length,1),B(e[0])&&e[0].value.length>0?e[0].value[e[0].value.length-1]:r()}function lo(...e){return s(e.length,1),B(e[0])?b(e[0].value.slice(1)):b([])}function No(...e){s(e.length,1);let t=e[0];return J(t),c(t.value.length===0)}function co(...e){s(e.length,1);let t=e[0];if(V(t))return i(0);if(C(e[0]))return i(e[0].value.size);if(B(e[0]))return i(e[0].value.length);throw new TypeError("Invalid argument type")}function mo(...e){s(e.length,1);let t=e[0];return oe(t)}function Ao(...e){s(e.length,1);let t=e[0];return c(se(t))}function fo(...e){s(e.length,1);let t=e[0];return W(t),t.value}function ho(...e){s(e.length,2);let t=e[0],o=e[1];return W(t),t.value=o,o}function go(...e){E(e.length,2);let t=e[0];W(t);let o=e[1];w(o);let n=e.slice(2);return t.value=o.value(t.value,...n),t.value}function vo(...e){throw s(e.length,1),m(e[0]),I(e[0])}function xo(...e){let t=e.length;E(t,2),w(e[0]);let o=e[t-1];return J(o),e[0].value(...e.slice(1,-1),...o.value)}function bo(...e){let t=e.length;s(t,2),w(e[0]),J(e[1]);let o=e[0],u=e[1].value.map(a=>o.value(a));return b(u)}function Co(...e){E(e.length,2),J(e[0]);let[t,...o]=e;return D(t)?b([...o.reverse(),...t.value]):A([...e[0].value,...o])}function So(...e){s(e.length,1);let t=e[0];return D(t)&&t.value.length>0?t:L(t)&&t.value.length>0?b([...t.value]):S(t)&&t.value.length>0?b(t.value.split("").map(o=>N(o))):r()}function Eo(...e){return s(e.length,1),_e(e[0]),e[0].metadata??r()}function wo(...e){s(e.length,2),_e(e[0]),m(e[1]);let t=G(e[0]);return t.metadata=e[1],t}function Mo(...e){return s(e.length,1),c(V(e[0]))}function To(...e){return s(e.length,1),c(X(e[0])&&e[0].value)}function Do(...e){return s(e.length,1),c(X(e[0])&&!e[0].value)}function Vo(...e){return s(e.length,1),c(S(e[0]))}function ut(...e){return s(e.length,1),d(e[0]),x(e[0].value)}function Po(...e){return s(e.length,1),c(k(e[0]))}function Lo(...e){s(e.length,1),O(e[0]);let t=e[0];if(_(t))return t;let o=e[0];return le(`:${o.value}`)}function Fo(...e){return s(e.length,1),c(_(e[0]))}function Io(...e){return s(e.length,1),c(g(e[0]))}function ko(...e){return s(e.length,1),c(K(e[0])&&!e[0].isMacro)}function Ro(...e){return s(e.length,1),c(K(e[0])?e[0].isMacro:!1)}function Bo(...e){return A(e)}function Uo(...e){return s(e.length,1),c(L(e[0]))}function pt(...e){if(e.length===0)return T();if(e.length===1&&C(e[0]))return T(new Map(e[0].value));ve(e.length);let t=T();for(let o=0;o<e.length;o+=2){let n=e[o];O(n),Be(t.value,n,e[o+1])}return t}function qo(...e){return s(e.length,1),c(C(e[0]))}function Ko(...e){E(e.length,1),U(e[0]);let t=e.slice(1),o=T(new Map(e[0].value)),n=pt(...t);for(let[u,a]of n.value.entries())o.value.set(u,a);return o}function Oo(...e){E(e.length,1),U(e[0]);let t=T(new Map(e[0].value));for(let o of e.splice(1))O(o),Ue(t.value,o);return t}function Go(...e){s(e.length,2);let t=e[0];if(!C(t))return r();let o=e[1];O(o);let n=Ke(t.value,o);return n!==void 0?n:r()}function Wo(...e){s(e.length,2);let t=e[0],o=e[1];return U(t),O(o),c(qe(t.value,o))}function jo(...e){return s(e.length,1),U(e[0]),Oe(e[0].value)}function $o(...e){return s(e.length,1),U(e[0]),b([...e[0].value.values()])}function _o(...e){return c(B(e[0]))}function Ho(...e){f(e.length,1,2),J(e[0]);let t=S(e[1])?e[1].value:" ",o=e[0].value.map(n=>R(n,!1)).join(t);return N(o)}function dn(...e){E(e.length,2);let[t,...o]=e,n=o.pop();ke(n),w(n);let u=o.length;for(let a=0;a<u;a++){let l=o[a];if(j(l),s(l.value.length,2),w(l.value[1]),te(t,l.value[0]).value)return l.value[1].value()}return n.value()}function ln(...e){console.log("getProp",JSON.stringify(e)),E(e.length,2),m(e[0]),d(e[1]);let t=e[1].value,o=null,n=e[0].value;if(Array.isArray(n)?o=n:n instanceof Map?o=Object.fromEntries(n):n instanceof Set?o=Array.from(n):n!==null&&typeof n=="object"&&(o=n),o===null)return r();let u=t.split(".").reduce((a,l)=>{if(a&&l in a)return a[l]},o);return y(u)}var ce={add:Xt,apply:xo,applyToSequence:bo,assoc:Ko,atom:mo,concat:uo,conj:Co,cons:ro,contains:Wo,deref:fo,dissoc:Oo,divide:to,empty:No,eq:Gt,firstNodeInList:ao,get:Go,gt:Jt,gte:Yt,hashMap:pt,isAtom:Ao,isFalse:Do,isFn:ko,isKeyword:Fo,isListNode:no,isMacro:Ro,isMap:qo,isNil:Mo,isNumber:Io,isSequentialNode:_o,isString:Vo,isSymbolNode:Po,isTrue:To,isVector:Uo,join:Ho,keys:jo,keyword:Lo,lastNodeInList:io,length:co,list:so,lt:Qt,lte:zt,meta:Eo,multiply:eo,ns:Kt,nsValues:Ot,nth:yo,printEscapedString:Wt,printEscapedStringToScreen:$t,printUnescapedString:jt,printUnescapedStringToScreen:rt,readString:_t,reset:ho,rest:lo,seq:So,subtract:Zt,swap:go,switchCase:dn,symbol:ut,throwError:vo,timeMs:oo,trim:Ht,vals:$o,vec:po,vector:Bo,withMeta:wo};var Nn=new Set(["!doctype","a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","imgmap","input","kbd","label","legend","li","link","main","mark","menu","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","portal","progress","q","rp","rt","ruby","s","samp","script","search","section","select","slot","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"]),Ze=new Map;for(let e of Nn)Ze.set(x(e),F(cn(e)));function cn(e){return(...t)=>mn(x(e),...t)}function mn(...e){E(e.length,1);let t=e[0];q(t);let o=new Map,n=[];return C(e[1])?(e[1].value.forEach((u,a)=>o.set(a,u)),e.slice(2).forEach(u=>n.push(u))):e.slice(1).forEach(u=>n.push(u)),ge(t.value,o,n)}function An(...e){s(e.length,1),d(e[0]);let t=e[0].value,o=document.querySelector(t);if(o===null)return r();let u=Array.from(o.attributes).reduce((a,l)=>a.set(l.name,N(l.value)),new Map);return ge(o.tagName,u,[])}Ze.set(x("document.querySelector"),F(An));var Xo=[["Array",hn],["Array.from",Qo],["Array.isArray",vn],["Array.of",Qo],["Array.prototype.at",gn],["Array.prototype.concat",xn],["Array.prototype.copyWithin",bn],["Array.prototype.entries",Cn],["Array.prototype.every",Sn],["Array.prototype.fill",En],["Array.prototype.filter",wn],["Array.prototype.find",Mn],["Array.prototype.findIndex",Tn],["Array.prototype.findLast",Dn],["Array.prototype.findLastIndex",Vn],["Array.prototype.flat",Pn],["Array.prototype.flatMap",Ln],["Array.prototype.includes",Fn],["Array.prototype.indexOf",In],["Array.prototype.join",kn],["Array.prototype.keys",Rn],["Array.prototype.length",Kn],["Array.prototype.map",Bn],["Array.prototype.pop",Un],["Array.prototype.push",qn],["Array.prototype.reduce",On],["Array.prototype.reverse",zo],["Array.prototype.shift",Gn],["Array.prototype.slice",Wn],["Array.prototype.some",jn],["Array.prototype.sort",Jo],["Array.prototype.splice",Yo],["Array.prototype.toReversed",zo],["Array.prototype.toSorted",Jo],["Array.prototype.toSpliced",Yo],["Array.prototype.unshift",$n],["Array.prototype.values",_n],["Array.prototype.with",Hn],["Array.toString",ce.printEscapedString]];function hn(...e){if(E(e.length,1),e.length===1&&g(e[0])){let t=Array(e[0].value).fill(r());return A(t)}return A(e)}function Qo(...e){f(e.length,1,3),h(e[0]),e.length>=2&&w(e[1]),e.length===3&&m(e[2]);let t=Array.from(e[0].value,e[1]?.value,e[2]?.value);return A(t)}function gn(...e){s(e.length,2),h(e[0]),p(e[1]);let t=e[0].value,o=e[1].value,n=t.at(o);return n?y(n):r()}function vn(...e){s(e.length,1),m(e[0]);let t=L(e[0]);return c(t)}function xn(...e){E(e.length,1),Y(e,he);let t=e[0].value.concat(...e.slice(1).map(o=>o.value));return A(t)}function bn(...e){f(e.length,1,4),h(e[0]),p(e[1]),p(e[2]);let t=e[0].value,o=e[1].value,n=e[2].value,u=g(e[3])?e[3].value:void 0,a=t.copyWithin(o,n,u);return A(a)}function Cn(...e){s(e.length,1),h(e[0]);let t=e[0].value.map((o,n)=>{let u=i(n);return A([u,o])});return A(t)}function Sn(...e){s(e.length,2),h(e[0]),w(e[1]);let t=e[0].value,o=e[1].value,n=t.every((u,a,l)=>o(i(a),u,A(l)).value);return c(n)}function En(...e){f(e.length,2,4),h(e[0]),m(e[1]);let t=e[0].value.map(H),o=e[1].value,n;e.length>=3&&(p(e[2]),n=e[2].value);let u;e.length===4&&(p(e[3]),u=e[3].value);let a=t.fill(o,n,u);return A(a.map(y))}function wn(...e){s(e.length,2),w(e[0]),h(e[1]);let t=e[0],n=e[1].value.filter(u=>!!t.value(u).value);return A(n)}function Mn(...e){s(e.length,2),h(e[0]),w(e[1]);let t=e[0].value,o=e[1].value;return t.find((u,a,l)=>o(u,i(a),A(l)).value)??r()}function Tn(...e){s(e.length,2),h(e[0]),w(e[1]);let t=e[0].value,o=e[1].value,n=t.findIndex((u,a,l)=>o(u,i(a),A(l)).value);return i(n)}function Dn(...e){s(e.length,2),h(e[0]),w(e[1]);let t=e[0].value,o=e[1].value;return t.findLast((u,a,l)=>o(u,i(a),A(l)).value)??r()}function Vn(...e){s(e.length,2),h(e[0]),w(e[1]);let t=e[0].value,o=e[1].value,n=t.findLastIndex((u,a,l)=>o(u,i(a),A(l)).value);return i(n)}function Pn(...e){s(e.length,1),h(e[0]);let t=e[0].value;function o(u){return u.reduce((a,l)=>a.concat(L(l)?o(l.value):l),[])}let n=o(t);return A(n)}function Ln(...e){s(e.length,2),h(e[0]),w(e[1]);let t=e[0].value,o=e[1].value;function n(l){return l.reduce((v,P)=>v.concat(L(P)?n(P.value):P),[])}let u=t.map((l,v,P)=>o(l,i(v),A(P))),a=n(u);return A(a)}function Fn(...e){s(e.length,2),h(e[0]),m(e[1]);let t=e[0],o=e[1],n=t.value.some(u=>te(u,o).value);return c(n)}function In(...e){s(e.length,2),h(e[0]),m(e[1]);let t=e[0],o=e[1];for(let[n,u]of t.value.entries())if(te(u,o).value)return i(n);return i(-1)}function kn(...e){f(e.length,1,2),J(e[0]);let t=S(e[1])?e[1].value:" ",o=e[0].value.map(n=>R(n,!1)).join(t);return N(o)}function Rn(...e){s(e.length,1),h(e[0]);let o=e[0].value.map((n,u)=>i(u));return A(o)}function Bn(...e){f(e.length,2,3),h(e[0]),w(e[1]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=t.map((a,l,v)=>{let P=o(a,i(l),n);return y(P)});return A(u)}function Un(...e){s(e.length,1),h(e[0]);let t=e[0],o=t.value[t.value.length-1];return y(o)}function qn(...e){if(E(e.length,2),!e.every($))throw new TypeError("Invalid arguments.");return h(e[0]),A([...e[0].value,...e.slice(1)])}function Kn(...e){s(e.length,1),h(e[0]);let t=e[0];return i(t.value.length)}function On(...e){s(e.length,3),w(e[0]),h(e[1]);let t=e[0],o=e[1],n=e[2];for(let u of o.value)n=t.value(n,u);return n}function zo(...e){s(e.length,1),h(e[0]);let o=e[0].value.toReversed();return A(o)}function Gn(...e){s(e.length,1),h(e[0]);let o=e[0].value[0];return o||r()}function Wn(...e){f(e.length,1,3),h(e[0]);let t=0;e[1]!==void 0&&(p(e[1]),t=e[1].value);let o=e[0].value.length;return e[2]!==void 0&&(p(e[2]),o=e[2].value),A(e[0].value.slice(t,o))}function jn(...e){s(e.length,2),h(e[0]),w(e[1]);let t=e[0].value,o=e[1].value,n=t.some((u,a,l)=>o(u,i(a),A(l)).value);return c(n)}function Jo(...e){s(e.length,2),h(e[0]),w(e[1]);let t=e[0].value,o=e[1].value,n=t.toSorted((u,a)=>{let l=o(u,a);return p(l),l.value});return A(n)}function Yo(...e){f(e.length,2,4),h(e[0]),p(e[1]);let t=e[0].value,o=e[1].value;if(e.length<3){let l=t.toSpliced(o);return A(l)}p(e[2]);let n=e[2].value,u=e.slice(3),a=t.toSpliced(o,n,...u);return A(a)}function $n(...e){s(e.length,2),h(e[1]);let t=[e[0],...e[1].value];return A(t)}function _n(...e){s(e.length,1),h(e[0]);let o=e[0].value.map(n=>n);return A(o)}function Hn(...e){s(e.length,3),h(e[0]),p(e[1]),m(e[2]);let t=e[0],o=e[1],n=e[2],u=t.value.with(o.value,n);return A(u)}var Zo=[["Boolean",Qn]];function Qn(...e){return s(e.length,1),m(e[0]),c(!!e[0].value)}var es=[["decodeURI",zn],["decodeURIComponent",Jn],["encodeURI",Yn],["encodeURIComponent",Xn]];function zn(...e){s(e.length,1),d(e[0]);let t=decodeURI(e[0].value);return N(t)}function Jn(...e){s(e.length,1),d(e[0]);let t=decodeURIComponent(e[0].value);return N(t)}function Yn(...e){s(e.length,1),d(e[0]);let t=encodeURI(e[0].value);return N(t)}function Xn(...e){s(e.length,1),d(e[0]);let t=encodeURIComponent(e[0].value);return N(t)}var ts=[["Date",Zn],["Date.now",er],["Date.parse",tr],["Date.UTC",or],["Date.prototype.getDate",sr],["Date.prototype.getDay",nr],["Date.prototype.getFullYear",rr],["Date.prototype.getHours",ur],["Date.prototype.getMilliseconds",pr],["Date.prototype.getMinutes",yr],["Date.prototype.getMonth",ar],["Date.prototype.getSeconds",ir],["Date.prototype.getTime",dr],["Date.prototype.getTimezoneOffset",lr],["Date.prototype.getUTCDate",Nr],["Date.prototype.getUTCDay",cr],["Date.prototype.getUTCFullYear",mr],["Date.prototype.getUTCHours",Ar],["Date.prototype.getUTCMilliseconds",fr],["Date.prototype.getUTCMinutes",hr],["Date.prototype.getUTCMonth",gr],["Date.prototype.getUTCSeconds",vr],["Date.prototype.setDate",xr],["Date.prototype.setFullYear",br],["Date.prototype.setHours",Cr],["Date.prototype.setMilliseconds",Sr],["Date.prototype.setMinutes",Er],["Date.prototype.setMonth",wr],["Date.prototype.setSeconds",Mr],["Date.prototype.setTime",Tr],["Date.prototype.setUTCDate",Dr],["Date.prototype.setUTCFullYear",Vr],["Date.prototype.setUTCHours",Pr],["Date.prototype.setUTCMilliseconds",Lr],["Date.prototype.setUTCMinutes",Fr],["Date.prototype.setUTCMonth",Ir],["Date.prototype.setUTCSeconds",kr],["Date.prototype.toDateString",Rr],["Date.prototype.toISOString",Br],["Date.prototype.toJSON",Ur],["Date.prototype.toLocaleDateString",qr],["Date.prototype.toLocaleString",Kr],["Date.prototype.toLocaleTimeString",Or],["Date.prototype.toString",Gr],["Date.prototype.toTimeString",Wr],["Date.prototype.toUTCString",jr]];function Zn(...e){let t=e.map(H),o=t.length>0?new Date(...t):new Date;return i(o.getTime())}function er(...e){return i(Date.now())}function tr(...e){s(e.length,1),d(e[0]);let t=Date.parse(e[0].value);return i(t)}function or(...e){let t=e.map(H),o=Date.UTC(...t);return Number.isNaN(o)?r():i(o)}function sr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getDate())}function nr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getDay())}function rr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getFullYear())}function ur(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getHours())}function pr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getMilliseconds())}function yr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getMinutes())}function ar(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getMonth())}function ir(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getSeconds())}function dr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getTime())}function lr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getTimezoneOffset())}function Nr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getUTCDate())}function cr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getUTCDay())}function mr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getUTCFullYear())}function Ar(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getUTCHours())}function fr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getUTCMilliseconds())}function hr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getUTCMinutes())}function gr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getUTCMonth())}function vr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return i(t.getUTCSeconds())}function xr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setDate(e[1].value),i(t.getTime())}function br(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setFullYear(e[1].value),i(t.getTime())}function Cr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setHours(e[1].value),i(t.getTime())}function Sr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setMilliseconds(e[1].value),i(t.getTime())}function Er(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setMinutes(e[1].value),i(t.getTime())}function wr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setMonth(e[1].value),i(t.getTime())}function Mr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setSeconds(e[1].value),i(t.getTime())}function Tr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setTime(e[1].value),i(t.getTime())}function Dr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCDate(e[1].value),i(t.getTime())}function Vr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCFullYear(e[1].value),i(t.getTime())}function Pr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCHours(e[1].value),i(t.getTime())}function Lr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCMilliseconds(e[1].value),i(t.getTime())}function Fr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCMinutes(e[1].value),i(t.getTime())}function Ir(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCMonth(e[1].value),i(t.getTime())}function kr(...e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCSeconds(e[1].value),i(t.getTime())}function Rr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return N(t.toDateString())}function Br(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return N(t.toISOString())}function Ur(...e){f(e.length,1,2),p(e[0]),e[1]&&d(e[1]);let t=new Date(e[0].value);return N(t.toJSON())}function qr(...e){f(e.length,1,3),p(e[0]);let t=new Date(e[0].value),o=e.slice(1).map(H);return N(t.toLocaleDateString(...o))}function Kr(...e){f(e.length,1,3),p(e[0]);let t=new Date(e[0].value),o=e.slice(1).map(H);return N(t.toLocaleString(...o))}function Or(...e){f(e.length,1,3),p(e[0]);let t=new Date(e[0].value),o=e.slice(1).map(H);return N(t.toLocaleTimeString(...o))}function Gr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return N(t.toString())}function Wr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return N(t.toTimeString())}function jr(...e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return N(t.toUTCString())}var os=[["Error",$r],["Error.prototype.message",_r],["Error.prototype.cause",Hr],["Error.prototype.name",Qr]];function $r(...e){f(e.length,1,3);let t=e[0];d(t);let o;if(e[1]!==void 0){if(!S(e[1])&&!V(e[1]))throw new TypeError("Second argument must be a string or nil.");S(e[1])&&(Ae.assertErrorName(e[1]),o=e[1])}let n;return e[2]!==void 0&&(m(e[2]),n=e[2]),I(t,o,n)}function _r(...e){return s(e.length,1),Ie(e[0]),e[0].value}function Hr(...e){return s(e.length,1),Ie(e[0]),e[0].cause??r()}function Qr(...e){return s(e.length,1),Ie(e[0]),e[0].name}var ns=[["Function",ss],["Function.isFunction",ce.isFn],["Function.prototype.apply",zr],["Function.prototype.bind",Yr],["Function.prototype.call",Jr],["js-eval",ss]];function ss(...e){s(e.length,1),d(e[0]);try{let t=new Function(`'use strict'; return (${e[0].value})`)();return y(t)}catch(t){return t instanceof Error?I(N(t.message)):I(N(JSON.stringify(t)))}}function zr(...e){s(e.length,2),w(e[0]),h(e[1]);let t=e[0].value.apply(null,e[1].value);return y(t)}function Jr(...e){E(e.length,1),w(e[0]);let t=e[0].value.call(null,...e.slice(1));return y(t)}function Yr(...e){E(e.length,2),w(e[0]),m(e[1]);let t=e[0].value.bind(e[1],...e.slice(2));return y(t)}var rs=[["Map.isMap",Xr],["Map.new",us],["Map.prototype.delete",tu],["Map.prototype.entries",Zr],["Map.prototype.get",ou],["Map.prototype.has",su],["Map.prototype.keys",nu],["Map.prototype.set",eu],["Map.prototype.size",uu],["Map.prototype.values",ru]];function Xr(...e){return s(e.length,1),c(C(e[0]))}function us(...e){if(e.length===0)return T();if(e.length===1&&C(e[0]))return T(new Map(e[0].value));ve(e.length);let t=T();for(let o=0;o<e.length;o+=2){let n=e[o];O(n),Be(t.value,n,e[o+1])}return t}function Zr(...e){s(e.length,1),U(e[0]);let t=e[0].value.entries(),o=A();for(let[n,u]of t){let a=A([y(n),y(u)]);o.value.push(a)}return o}function eu(...e){E(e.length,1),U(e[0]);let t=e.slice(1),o=T(new Map(e[0].value)),n=us(...t);for(let[u,a]of n.value.entries())o.value.set(u,a);return o}function tu(...e){E(e.length,1),U(e[0]);let t=T(new Map(e[0].value));for(let o of e.splice(1))O(o),Ue(t.value,o);return t}function ou(...e){s(e.length,2);let t=e[0];if(!C(t))return r();let o=e[1];O(o);let n=Ke(t.value,o);return n!==void 0?n:r()}function su(...e){s(e.length,2);let t=e[0],o=e[1];return U(t),O(o),c(qe(t.value,o))}function nu(...e){return s(e.length,1),U(e[0]),Oe(e[0].value)}function ru(...e){return s(e.length,1),U(e[0]),b([...e[0].value.values()])}function uu(...e){s(e.length,1);let t=e[0];if(V(t))return i(0);if(C(e[0]))return i(e[0].value.size);if(B(e[0]))return i(e[0].value.length);throw new TypeError("Invalid argument type")}var ps=[["Math.abs",pu],["Math.acos",yu],["Math.acosh",au],["Math.asin",iu],["Math.asinh",du],["Math.atan",lu],["Math.atan2",Nu],["Math.atanh",cu],["Math.cbrt",mu],["Math.ceil",Au],["Math.clz32",fu],["Math.cos",hu],["Math.cosh",gu],["Math.exp",vu],["Math.expm1",xu],["Math.floor",bu],["Math.fround",Cu],["Math.hypot",Su],["Math.imul",Eu],["Math.log",wu],["Math.log10",Mu],["Math.log1p",Tu],["Math.log2",Du],["Math.max",Vu],["Math.min",Pu],["Math.pow",Lu],["Math.random",Fu],["Math.round",Iu],["Math.sign",ku],["Math.sin",Ru],["Math.sinh",Bu],["Math.sqrt",Uu],["Math.tan",qu],["Math.tanh",Ku],["Math.trunc",Ou],["Math.E",Gu],["Math.LN10",Wu],["Math.LN2",ju],["Math.LOG10E",$u],["Math.LOG2E",_u],["Math.PI",Hu],["Math.SQRT1_2",Qu],["Math.SQRT2",zu]];function pu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.abs(t);return y(o)}function yu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.acos(t);return y(o)}function au(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.acosh(t);return y(o)}function iu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.asin(t);return y(o)}function du(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.asinh(t);return y(o)}function lu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.atan(t);return y(o)}function Nu(...e){s(e.length,2),p(e[0]),p(e[1]);let t=e[0].value,o=e[1].value,n=Math.atan2(t,o);return y(n)}function cu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.atanh(t);return y(o)}function mu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.cbrt(t);return y(o)}function Au(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.ceil(t);return y(o)}function fu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.clz32(t);return y(o)}function hu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.cos(t);return y(o)}function gu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.cosh(t);return y(o)}function vu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.exp(t);return y(o)}function xu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.expm1(t);return y(o)}function bu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.floor(t);return y(o)}function Cu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.fround(t);return y(o)}function Su(...e){Y(e,ee);let t=e.map(ae),o=Math.hypot(...t);return y(o)}function Eu(...e){s(e.length,2),p(e[0]),p(e[1]);let t=e[0].value,o=e[1].value,n=Math.imul(t,o);return y(n)}function wu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.log(t);return y(o)}function Mu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.log10(t);return y(o)}function Tu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.log1p(t);return y(o)}function Du(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.log2(t);return y(o)}function Vu(...e){Y(e,ee);let t=e.map(ae),o=Math.max(...t);return y(o)}function Pu(...e){Y(e,ee);let t=e.map(ae),o=Math.min(...t);return y(o)}function Lu(...e){if(e.length===2&&g(e[0])&&g(e[1])){let t=e[0].value,o=e[1].value,n=t**o;return y(n)}throw new TypeError('Invalid arguments to "Math.pow"')}function Fu(...e){if(e.length===0){let t=Math.random();return y(t)}throw new TypeError('Invalid arguments to "Math.random"')}function Iu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.round(t);return y(o)}function ku(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.sign(t);return y(o)}function Ru(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.sin(t);return y(o)}function Bu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.sinh(t);return y(o)}function Uu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.sqrt(t);return y(o)}function qu(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.tan(t);return y(o)}function Ku(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.tanh(t);return y(o)}function Ou(...e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.trunc(t);return y(o)}function Gu(...e){if(e.length===0)return y(Math.E);throw new TypeError('Invalid arguments to "Math.E"')}function Wu(...e){if(e.length===0)return y(Math.LN10);throw new TypeError('Invalid arguments to "Math.LN10"')}function ju(...e){if(e.length===0)return y(Math.LN2);throw new TypeError('Invalid arguments to "Math.LN2"')}function $u(...e){if(e.length===0)return y(Math.LOG10E);throw new TypeError('Invalid arguments to "Math.LOG10E"')}function _u(...e){if(e.length===0)return y(Math.LOG2E);throw new TypeError('Invalid arguments to "Math.LOG2E"')}function Hu(...e){if(e.length===0)return y(Math.PI);throw new TypeError('Invalid arguments to "Math.PI"')}function Qu(...e){if(e.length===0)return y(Math.SQRT1_2);throw new TypeError('Invalid arguments to "Math.SQRT1_2"')}function zu(...e){if(e.length===0)return y(Math.SQRT2);throw new TypeError('Invalid arguments to "Math.SQRT2"')}var ys=[["Number",Ju],["Number.isFinite",Yu],["Number.isInteger",Xu],["Number.isNaN",Zu],["Number.isSafeInteger",ep],["Number.parseFloat",tp],["Number.parseInt",op],["Number.prototype.toExponential",dp],["Number.prototype.toFixed",lp],["Number.prototype.toPrecision",Np],["Number.prototype.toString",cp],["Number.EPSILON",sp],["Number.MAX_SAFE_INTEGER",np],["Number.MAX_VALUE",rp],["Number.MIN_SAFE_INTEGER",up],["Number.MIN_VALUE",pp],["Number.NaN",yp],["Number.NEGATIVE_INFINITY",ap],["Number.POSITIVE_INFINITY",ip]];function Ju(...e){if(e.length===1&&$(e[0])){let t=e[0].value,o=Number(t);return y(o)}throw new TypeError('Invalid arguments to "Number"')}function Yu(...e){if(e.length===1&&$(e[0])){let t=e[0].value,o=Number.isFinite(t);return y(o)}throw new TypeError('Invalid arguments to "Number.isFinite"')}function Xu(...e){if(e.length===1&&$(e[0])){let t=e[0].value,o=Number.isInteger(t);return y(o)}throw new TypeError('Invalid arguments to "Number.isInteger"')}function Zu(...e){if(e.length===1&&$(e[0])){let t=e[0].value,o=Number.isNaN(t);return y(o)}throw new TypeError('Invalid arguments to "Number.isNaN"')}function ep(...e){if(e.length===1&&$(e[0])){let t=e[0].value,o=Number.isSafeInteger(t);return y(o)}throw new TypeError('Invalid arguments to "Number.isSafeInteger"')}function tp(...e){s(e.length,1),d(e[0]);let t=xe(e[0]),o=Number.parseFloat(t);return y(o)}function op(...e){f(e.length,1,2),d(e[0]);let t=e[0].value;if(e.length===2){p(e[1]);let n=e[1].value,u=Number.parseInt(t,n);return i(u)}let o=Number.parseInt(t);return i(o)}function sp(...e){if(e.length===0){let t=Number.EPSILON;return y(t)}throw new TypeError('Invalid arguments to "Number.EPSILON"')}function np(...e){if(e.length===0){let t=Number.MAX_SAFE_INTEGER;return y(t)}throw new TypeError('Invalid arguments to "Number.MAX_SAFE_INTEGER"')}function rp(...e){if(e.length===0){let t=Number.MAX_VALUE;return y(t)}throw new TypeError('Invalid arguments to "Number.MAX_VALUE"')}function up(...e){if(e.length===0){let t=Number.MIN_SAFE_INTEGER;return y(t)}throw new TypeError('Invalid arguments to "Number.MIN_SAFE_INTEGER"')}function pp(...e){if(e.length===0){let t=Number.MIN_VALUE;return y(t)}throw new TypeError('Invalid arguments to "Number.MIN_VALUE"')}function yp(...e){if(e.length===0){let t=Number.NaN;return y(t)}throw new TypeError('Invalid arguments to "Number.NaN"')}function ap(...e){if(e.length===0){let t=Number.NEGATIVE_INFINITY;return y(t)}throw new TypeError('Invalid arguments to "Number.NEGATIVE_INFINITY"')}function ip(...e){if(e.length===0){let t=Number.POSITIVE_INFINITY;return y(t)}throw new TypeError('Invalid arguments to "Number.POSITIVE_INFINITY"')}function dp(...e){if(f(e.length,1,2),p(e[0]),e.length===2){p(e[1]);let o=e[1].value,n=e[0].value.toExponential(o);return N(n)}let t=e[0].value.toExponential();return N(t)}function lp(...e){if(f(e.length,1,2),p(e[0]),e.length===2){p(e[1]);let o=e[1].value,n=e[0].value.toFixed(o);return N(n)}let t=e[0].value.toFixed();return N(t)}function Np(...e){if(f(e.length,1,2),p(e[0]),e.length===2){p(e[1]);let o=e[1].value,n=e[0].value.toPrecision(o);return N(n)}let t=e[0].value.toPrecision();return N(t)}function cp(...e){if(f(e.length,1,2),p(e[0]),e.length===2){p(e[1]);let o=e[1].value,n=e[0].value.toString(o);return N(n)}let t=e[0].value.toString();return N(t)}var as=[["typeof",Dp],["instanceof",Vp],["neq",wp],["nullish",Pp],["power",Lp],["remainder",fp],["rshift",Cp],["lshift",bp],["rshift-unsigned",Sp],["bit-and",hp],["bit-or",gp],["bit-xor",vp],["bit-not",xp],["and",mp],["or",Ap],["not",Ep],["increment",Mp],["decrement",Tp]];function mp(...e){for(let o of e)if(!Re(o,!0))return c(!1);return c(!0)}function Ap(...e){for(let t of e)if(Re(t))return c(!0);return c(!1)}function fp(e,t){if(g(e)&&g(t))return i((e.value%t.value+t.value)%t.value);throw new TypeError("not a number")}function hp(e,t){if(g(e)&&g(t))return i(e.value&t.value);throw new TypeError("not a number")}function gp(e,t){if(g(e)&&g(t))return i(e.value|t.value);throw new TypeError("not a number")}function vp(e,t){if(g(e)&&g(t))return i(e.value^t.value);throw new TypeError("not a number")}function xp(e){if(g(e))return i(~e.value);throw new TypeError("not a number")}function bp(e,t){if(g(e)&&g(t))return i(e.value<<t.value);throw new TypeError("not a number")}function Cp(e,t){if(g(e)&&g(t))return i(e.value>>t.value);throw new TypeError("not a number")}function Sp(e,t){if(g(e)&&g(t))return i(e.value>>>t.value);throw new TypeError("not a number")}function Ep(e){return c(!e.value)}function wp(...e){s(e.length,2);let t=te(e[0],e[1]);return c(!t.value)}function Mp(...e){f(e.length,1,2),p(e[0]);let t="postfix";if(e[1]!==void 0){if(d(e[1]),e[1].value!=="prefix"&&e[1].value!=="postfix")throw new TypeError(`Invalid affix ${String(e[1].value)}. The affix must be "prefix" or "postfix"`);t=e[1].value}if(t==="postfix")return A([i(e[0].value+1),i(e[0].value)]);if(t==="prefix")return A([i(e[0].value+1),i(e[0].value+1)]);throw new Error("Unhandled error in decrement")}function Tp(...e){f(e.length,1,2),p(e[0]);let t="postfix";if(e[1]!==void 0){if(d(e[1]),e[1].value!=="prefix"&&e[1].value!=="postfix")throw new TypeError(`Invalid affix ${String(e[1].value)}. The affix must be "prefix" or "postfix"`);t=e[1].value}if(t==="postfix")return A([i(e[0].value-1),i(e[0].value)]);if(t==="prefix")return A([i(e[0].value-1),i(e[0].value-1)]);throw new Error("Unhandled error in decrement")}function Dp(...e){s(e.length,2),m(e[0]),d(e[1]);let t=typeof e[0].value;if(t!=="bigint"&&t!=="boolean"&&t!=="function"&&t!=="number"&&t!=="object"&&t!=="string"&&t!=="symbol"&&t!=="undefined")throw new Error(`Invalid type: "${e[1].value}". Type must be one of bigint, boolean, function, number, object, string, symbol, or undefined`);return c(t===e[1].value)}function Vp(...e){s(e.length,2),m(e[0]),d(e[1]);let t=e[0],o=e[1].value,n;if(o==="AstNode"||o==="AtomNode"||o==="BooleanNode"||o==="ErrorNode"||o==="FunctionNode"||o==="KeywordNode"||o==="ListNode"||o==="MapNode"||o==="NilNode"||o==="NumberNode"||o==="StringNode"||o==="SymbolNode"||o==="VectorNode")n=M[e[1].value];else if(Object.hasOwn(globalThis,e[1].value))n=globalThis[e[1].value];else throw new TypeError(`Unknown instance: "${e[1].value}"`);return c(t instanceof n)}function Pp(e,t){return e.value==null?t:e}function Lp(e,t){if(g(e)&&g(t))return i(e.value**t.value);throw new TypeError("not a number")}var is=[["RegExp.new",Fp],["RegExp.prototype.exec",Ip],["RegExp.prototype.test",kp]];function Fp(...e){f(e.length,1,2),d(e[0]);let t=e[0].value;if(e.length===2){d(e[1]);let n=e[1].value,u=new RegExp(t,n);return oe(u)}let o=new RegExp(t);return oe(o)}function Ip(...e){s(e.length,2),W(e[0]);let t=e[0].value;re(t),d(e[1]);let o=e[1].value,n=t.exec(o);return n?A(n.map(y)):r()}function kp(...e){s(e.length,2),W(e[0]),re(e[0].value),d(e[1]);let t=e[0].value.test(e[1].value);return c(t)}var Ns=[["String",ce.printUnescapedString],["String.fromCharCode",Rp],["String.fromCodePoint",Bp],["String.prototype.at",ds],["String.prototype.charAt",ds],["String.prototype.charCodeAt",ls],["String.prototype.codePointAt",ls],["String.prototype.concat",Up],["String.prototype.endsWith",qp],["String.prototype.includes",Kp],["String.prototype.indexOf",Op],["String.prototype.isWellFormed",Gp],["String.prototype.lastIndexOf",Wp],["String.prototype.length",jp],["String.prototype.localeCompare",$p],["String.prototype.match",_p],["String.prototype.matchAll",Hp],["String.prototype.normalize",Qp],["String.prototype.padEnd",zp],["String.prototype.padStart",Jp],["String.prototype.repeat",Yp],["String.prototype.replace",Xp],["String.prototype.replaceAll",Zp],["String.prototype.search",ey],["String.prototype.slice",ty],["String.prototype.split",oy],["String.prototype.startsWith",sy],["String.prototype.toLocaleLowerCase",ny],["String.prototype.toLocaleUpperCase",ry],["String.prototype.toLowerCase",uy],["String.prototype.toUpperCase",py],["String.prototype.toWellFormed",yy],["String.prototype.trim",ay],["String.prototype.trimEnd",iy],["String.prototype.trimStart",dy],["String.raw",ly]];function Rp(...e){s(e.length,1),h(e[0]),Y(e[0].value,ee);let t=e[0].value.map(ae),o=String.fromCharCode(...t);return N(o)}function Bp(...e){Y(e,ee);let t=e.map(ae),o=String.fromCodePoint(...t);return N(o)}function ds(...e){s(e.length,2),d(e[0]),p(e[1]);let t=String.prototype.at.call(e[0].value,e[1].value);return t===void 0?r():N(t)}function ls(...e){s(e.length,2),d(e[0]),p(e[1]);let t=String.prototype.codePointAt.call(e[0].value,e[1].value);return t===void 0?r():i(t)}function Up(...e){E(e.length,2),Y(e,de);let t=e[0].value,o=e.slice(1).map(xe),n=String.prototype.concat.call(t,...o);return N(n)}function qp(...e){f(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.endsWith.call(t,o,n);return y(u)}function Kp(...e){f(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.includes.call(t,o,n);return y(u)}function Op(...e){f(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.indexOf.call(t,o,n);return y(u)}function Gp(...e){s(e.length,1),d(e[0]);let t=e[0].value,o=String.prototype.isWellFormed.call(t);return y(o)}function Wp(...e){f(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.lastIndexOf.call(t,o,n);return y(u)}function jp(...e){s(e.length,1),m(e[0]);let o=e[0].value.length;return y(o)}function $p(...e){f(e.length,2,4),d(e[0]),d(e[1]);let t=e[0].value,o=e[1].value,n,u;if(e.length>2){let l=e[2];S(l)?n=l.value:L(l)?(Y(l.value,de),n=l.value.map(xe)):(tt(l),n=void 0)}if(e.length>3){let l=e[3];U(l),u=We(l)}let a=String.prototype.localeCompare.call(t,o,n,u);return y(a)}function _p(...e){s(e.length,2),d(e[0]),W(e[1]),re(e[1].value);let t=e[0].value,o=e[1].value,n=String.prototype.match.call(t,o);return y(n)}function Hp(...e){s(e.length,2),d(e[0]),W(e[1]),re(e[1].value);let t=e[0].value,o=e[1].value,n=String.prototype.matchAll.call(t,o);return y(n)}function Qp(...e){f(e.length,1,2),m(e[0]),e.length===2&&d(e[1]);let t=e[0].value,o=e.length===2?e[1].value:void 0,n=String.prototype.normalize.call(t,o);return y(n)}function zp(...e){f(e.length,2,3),m(e[0]),p(e[1]),e.length===3&&d(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.padEnd.call(t,o,n);return y(u)}function Jp(...e){f(e.length,2,3),m(e[0]),p(e[1]),e.length===3&&d(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.padStart.call(t,o,n);return y(u)}function Yp(...e){s(e.length,2),d(e[0]),p(e[1]);let t=e[0].value,o=e[1].value,n=String.prototype.repeat.call(t,o);return y(n)}function Xp(...e){s(e.length,3),d(e[0]);let t="";S(e[1])||(W(e[1]),re(e[1].value)),t=e[1].value;let o;if(S(e[2]))o=e[2].value;else throw new Error("Function replacers are not implemented for String.prototype.replace");let u=e[0].value.replace(t,o);return y(u)}function Zp(...e){s(e.length,3),d(e[0]);let t="";S(e[1])||(W(e[1]),re(e[1].value)),t=e[1].value;let o;if(S(e[2]))o=e[2].value;else throw new Error("Function replacers are not implemented for String.prototype.replaceAll");let u=e[0].value.replaceAll(t,o);return y(u)}function ey(...e){s(e.length,2),d(e[0]),W(e[1]),re(e[1].value);let t=e[0].value,o=e[1].value,n=String.prototype.search.call(t,o);return y(n)}function ty(...e){f(e.length,1,3),m(e[0]),e.length>1&&p(e[1]),e.length>2&&p(e[2]);let t=e[0].value,o=e.length>1?e[1].value:void 0,n=e.length>2?e[2].value:void 0,u=String.prototype.slice.call(t,o,n);return y(u)}function oy(...e){f(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=t.split(o,n);return y(u)}function sy(...e){f(e.length,2,3),m(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length>2?e[2].value:void 0,u=String.prototype.startsWith.call(t,o,n);return y(u)}function ny(...e){f(e.length,1,2),m(e[0]),e.length===2&&(V(e[1])||d(e[1]));let t=e[0].value,o=e.length===2&&!V(e[1])?e[1].value:void 0,n=String.prototype.toLocaleLowerCase.call(t,o);return y(n)}function ry(...e){f(e.length,1,2),m(e[0]),e.length===2&&(V(e[1])||d(e[1]));let t=e[0].value,o=e.length===2&&!V(e[1])?e[1].value:void 0,n=String.prototype.toLocaleUpperCase.call(t,o);return y(n)}function uy(...e){s(e.length,1),m(e[0]);let t=e[0].value,o=String.prototype.toLowerCase.call(t);return y(o)}function py(...e){s(e.length,1),m(e[0]);let t=e[0].value,o=String.prototype.toUpperCase.call(t);return y(o)}function yy(...e){s(e.length,1),m(e[0]);let t=e[0].value,o=String.prototype.toWellFormed.call(t);return y(o)}function ay(...e){s(e.length,1),m(e[0]);let t=e[0].value,o=String.prototype.trim.call(t);return y(o)}function iy(...e){s(e.length,1),m(e[0]);let t=e[0].value,o=String.prototype.trimEnd.call(t);return y(o)}function dy(...e){s(e.length,1),m(e[0]);let t=e[0].value,o=String.prototype.trimStart.call(t);return y(o)}function ly(...e){s(e.length,2),U(e[0]),h(e[1]);let t=We(e[0]),o=e[1].value,n=String.raw(t,...o);return y(n)}var cs=[["Symbol",Ny],["Symbol.for",cy],["Symbol.keyFor",my]];function Ny(...e){f(e.length,0,1),e.length===1&&d(e[0]);let t=e.length===1?e[0].value:void 0,o=Symbol(t);return oe(o)}function cy(...e){s(e.length,1),d(e[0]);let t=e[0].value,o=Symbol.for(t);return oe(o)}function my(...e){s(e.length,1),W(e[0]),ot(e[0].value);let t=e[0].value,o=Symbol.keyFor(t);return o?N(o):r()}var Ay=[...Xo,...Zo,...es,...as,...ts,...os,...ns,...rs,...ps,...ys,...is,...Ns,...cs],$e=new Map;for(let[e,t]of Ay)if($e.set(x(e),F(t)),e.includes(".prototype.")){let o=e.replace(".prototype.","::");$e.set(x(o),F(t))}else if(e.includes(".prototype[")){let o=e.replace(".prototype[","::[");$e.set(x(o),F(t))}var yt=new Map,hy=[["CustomEvent::new",gy],["CustomEvent::prototype",vy],["CustomEvent.detail",xy],["CustomEvent::initCustomEvent",by],["Document::new",Cy],["Document::prototype",Sy],["Document::parseHTMLUnsafe",Ey],["Document.URL",wy],["Document.alinkColor",My],["Document.all",Ty],["Document.anchors",Dy],["Document.applets",Vy],["Document.bgColor",Py],["Document.body",Ly],["Document.characterSet",Fy],["Document.charset",Iy],["Document.compatMode",ky],["Document.contentType",Ry],["Document.cookie",By],["Document.currentScript",Uy],["Document.defaultView",qy],["Document.designMode",Ky],["Document.dir",Oy],["Document.doctype",Gy],["Document.documentElement",Wy],["Document.documentURI",jy],["Document.domain",$y],["Document.embeds",_y],["Document.fgColor",Hy],["Document.forms",Qy],["Document.fragmentDirective",zy],["Document.fullscreen",Jy],["Document.fullscreenEnabled",Yy],["Document.head",Xy],["Document.hidden",Zy],["Document.images",ea],["Document.implementation",ta],["Document.inputEncoding",oa],["Document.lastModified",sa],["Document.linkColor",na],["Document.links",ra],["Document.onfullscreenchange",ua],["Document.onfullscreenerror",pa],["Document.onpointerlockchange",ya],["Document.onpointerlockerror",aa],["Document.onreadystatechange",ia],["Document.onvisibilitychange",da],["Document.ownerDocument",la],["Document.pictureInPictureEnabled",Na],["Document.plugins",ca],["Document.readyState",ma],["Document.referrer",Aa],["Document.rootElement",fa],["Document.scripts",ha],["Document.scrollingElement",ga],["Document.timeline",va],["Document.title",xa],["Document.visibilityState",ba],["Document.vlinkColor",Ca],["Document::adoptNode",Sa],["Document::captureEvents",Ea],["Document::caretPositionFromPoint",wa],["Document::caretRangeFromPoint",Ma],["Document::clear",Ta],["Document::close",Da],["Document::createAttribute",Va],["Document::createAttributeNS",Pa],["Document::createCDATASection",La],["Document::createComment",Fa],["Document::createDocumentFragment",Ia],["Document::createElement",ka],["Document::createElementNS",Ra],["Document::createEvent",Ba],["Document::createNodeIterator",Ua],["Document::createProcessingInstruction",qa],["Document::createRange",Ka],["Document::createTextNode",Oa],["Document::createTreeWalker",Ga],["Document::execCommand",Wa],["Document::exitFullscreen",ja],["Document::exitPictureInPicture",$a],["Document::exitPointerLock",_a],["Document::getElementById",Ha],["Document::getElementsByClassName",Qa],["Document::getElementsByName",za],["Document::getElementsByTagName",Ja],["Document::getElementsByTagNameNS",Ya],["Document::getSelection",Xa],["Document::hasFocus",Za],["Document::hasStorageAccess",ei],["Document::importNode",ti],["Document::open",oi],["Document::queryCommandEnabled",si],["Document::queryCommandIndeterm",ni],["Document::queryCommandState",ri],["Document::queryCommandSupported",ui],["Document::queryCommandValue",pi],["Document::releaseEvents",yi],["Document::requestStorageAccess",ai],["Document::startViewTransition",ii],["Document::write",di],["Document::writeln",li],["Document::addEventListener",Ni],["Document::removeEventListener",ci],["DocumentFragment::new",ms],["DocumentFragment::prototype",As],["DocumentFragment.ownerDocument",fs],["DocumentFragment::getElementById",hs],["DocumentTimeline::new",mi],["DocumentTimeline::prototype",Ai],["DocumentType::new",xi],["DocumentType::prototype",bi],["DocumentType.name",fi],["DocumentType.ownerDocument",hi],["DocumentType.publicId",gi],["DocumentType.systemId",vi],["DocumentFragment::new",ms],["DocumentFragment::prototype",As],["DocumentFragment.ownerDocument",fs],["DocumentFragment::getElementById",hs],["Element::new",Ci],["Element::prototype",Si],["Element.attributes",Ei],["Element.classList",wi],["Element.className",Mi],["Element.clientHeight",Ti],["Element.clientLeft",Di],["Element.clientTop",Vi],["Element.clientWidth",Pi],["Element.currentCSSZoom",Li],["Element.id",Fi],["Element.innerHTML",Ii],["Element.localName",ki],["Element.namespaceURI",Ri],["Element.onfullscreenchange",Bi],["Element.onfullscreenerror",Ui],["Element.outerHTML",qi],["Element.ownerDocument",Ki],["Element.part",Oi],["Element.prefix",Gi],["Element.scrollHeight",Wi],["Element.scrollLeft",ji],["Element.scrollTop",$i],["Element.scrollWidth",_i],["Element.shadowRoot",Hi],["Element.slot",Qi],["Element.tagName",zi],["Element::attachShadow",Ji],["Element::checkVisibility",Yi],["Element::closest",Xi],["Element::computedStyleMap",Zi],["Element::getAttribute",ed],["Element::getAttributeNS",td],["Element::getAttributeNames",od],["Element::getAttributeNode",sd],["Element::getAttributeNodeNS",nd],["Element::getBoundingClientRect",rd],["Element::getClientRects",ud],["Element::getElementsByClassName",pd],["Element::getElementsByTagName",yd],["Element::getElementsByTagNameNS",ad],["Element::getHTML",id],["Element::hasAttribute",dd],["Element::hasAttributeNS",ld],["Element::hasAttributes",Nd],["Element::hasPointerCapture",cd],["Element::insertAdjacentElement",md],["Element::insertAdjacentHTML",Ad],["Element::insertAdjacentText",fd],["Element::matches",hd],["Element::releasePointerCapture",gd],["Element::removeAttribute",vd],["Element::removeAttributeNS",xd],["Element::removeAttributeNode",bd],["Element::requestFullscreen",Cd],["Element::requestPointerLock",Sd],["Element::scroll",Ed],["Element::scrollBy",wd],["Element::scrollIntoView",Md],["Element::scrollTo",Td],["Element::setAttribute",Dd],["Element::setAttributeNS",Vd],["Element::setAttributeNode",Pd],["Element::setAttributeNodeNS",Ld],["Element::setHTMLUnsafe",Fd],["Element::setPointerCapture",Id],["Element::toggleAttribute",kd],["Element::webkitMatchesSelector",Rd],["Element::addEventListener",Bd],["Element::removeEventListener",Ud],["Event::new",qd],["Event::prototype",Kd],["Event::NONE",Od],["Event::CAPTURING_PHASE",Gd],["Event::AT_TARGET",Wd],["Event::BUBBLING_PHASE",jd],["Event.bubbles",$d],["Event.cancelBubble",_d],["Event.cancelable",Hd],["Event.composed",Qd],["Event.currentTarget",zd],["Event.defaultPrevented",Jd],["Event.eventPhase",Yd],["Event.isTrusted",Xd],["Event.returnValue",Zd],["Event.srcElement",el],["Event.target",tl],["Event.timeStamp",ol],["Event.type",sl],["Event.NONE",nl],["Event.CAPTURING_PHASE",rl],["Event.AT_TARGET",ul],["Event.BUBBLING_PHASE",pl],["Event::composedPath",yl],["Event::initEvent",al],["Event::preventDefault",il],["Event::stopImmediatePropagation",dl],["Event::stopPropagation",ll],["EventTarget::new",Nl],["EventTarget::prototype",cl],["EventTarget::addEventListener",ml],["EventTarget::dispatchEvent",Al],["EventTarget::removeEventListener",fl]];for(let[e,t]of hy)yt.set(x(e),F(t));function gy(...e){return s(e.length,1),r()}function vy(...e){return s(e.length,1),r()}function xy(...e){return s(e.length,1),r()}function by(...e){return s(e.length,1),r()}function Cy(...e){return s(e.length,1),r()}function Sy(...e){return s(e.length,1),r()}function Ey(...e){return s(e.length,1),r()}function wy(...e){return s(e.length,1),r()}function My(...e){return s(e.length,1),r()}function Ty(...e){return s(e.length,1),r()}function Dy(...e){return s(e.length,1),r()}function Vy(...e){return s(e.length,1),r()}function Py(...e){return s(e.length,1),r()}function Ly(...e){return s(e.length,1),r()}function Fy(...e){return s(e.length,1),r()}function Iy(...e){return s(e.length,1),r()}function ky(...e){return s(e.length,1),r()}function Ry(...e){return s(e.length,1),r()}function By(...e){return s(e.length,1),r()}function Uy(...e){return s(e.length,1),r()}function qy(...e){return s(e.length,1),r()}function Ky(...e){return s(e.length,1),r()}function Oy(...e){return s(e.length,1),r()}function Gy(...e){return s(e.length,1),r()}function Wy(...e){return s(e.length,1),r()}function jy(...e){return s(e.length,1),r()}function $y(...e){return s(e.length,1),r()}function _y(...e){return s(e.length,1),r()}function Hy(...e){return s(e.length,1),r()}function Qy(...e){return s(e.length,1),r()}function zy(...e){return s(e.length,1),r()}function Jy(...e){return s(e.length,1),r()}function Yy(...e){return s(e.length,1),r()}function Xy(...e){return s(e.length,1),r()}function Zy(...e){return s(e.length,1),r()}function ea(...e){return s(e.length,1),r()}function ta(...e){return s(e.length,1),r()}function oa(...e){return s(e.length,1),r()}function sa(...e){return s(e.length,1),r()}function na(...e){return s(e.length,1),r()}function ra(...e){return s(e.length,1),r()}function ua(...e){return s(e.length,1),r()}function pa(...e){return s(e.length,1),r()}function ya(...e){return s(e.length,1),r()}function aa(...e){return s(e.length,1),r()}function ia(...e){return s(e.length,1),r()}function da(...e){return s(e.length,1),r()}function la(...e){return s(e.length,1),r()}function Na(...e){return s(e.length,1),r()}function ca(...e){return s(e.length,1),r()}function ma(...e){return s(e.length,1),r()}function Aa(...e){return s(e.length,1),r()}function fa(...e){return s(e.length,1),r()}function ha(...e){return s(e.length,1),r()}function ga(...e){return s(e.length,1),r()}function va(...e){return s(e.length,1),r()}function xa(...e){return s(e.length,1),r()}function ba(...e){return s(e.length,1),r()}function Ca(...e){return s(e.length,1),r()}function Sa(...e){return s(e.length,1),r()}function Ea(...e){return s(e.length,1),r()}function wa(...e){return s(e.length,1),r()}function Ma(...e){return s(e.length,1),r()}function Ta(...e){return s(e.length,1),r()}function Da(...e){return s(e.length,1),r()}function Va(...e){return s(e.length,1),r()}function Pa(...e){return s(e.length,1),r()}function La(...e){return s(e.length,1),r()}function Fa(...e){return s(e.length,1),r()}function Ia(...e){return s(e.length,1),r()}function ka(...e){return s(e.length,1),r()}function Ra(...e){return s(e.length,1),r()}function Ba(...e){return s(e.length,1),r()}function Ua(...e){return s(e.length,1),r()}function qa(...e){return s(e.length,1),r()}function Ka(...e){return s(e.length,1),r()}function Oa(...e){return s(e.length,1),r()}function Ga(...e){return s(e.length,1),r()}function Wa(...e){return s(e.length,1),r()}function ja(...e){return s(e.length,1),r()}function $a(...e){return s(e.length,1),r()}function _a(...e){return s(e.length,1),r()}function Ha(...e){s(e.length,1),d(e[0]);let t=Document.prototype.getElementById.call(document,e[0].value);return t?oe(t):r()}function Qa(...e){return s(e.length,1),r()}function za(...e){return s(e.length,1),r()}function Ja(...e){return s(e.length,1),r()}function Ya(...e){return s(e.length,1),r()}function Xa(...e){return s(e.length,1),r()}function Za(...e){return s(e.length,1),r()}function ei(...e){return s(e.length,1),r()}function ti(...e){return s(e.length,1),r()}function oi(...e){return s(e.length,1),r()}function si(...e){return s(e.length,1),r()}function ni(...e){return s(e.length,1),r()}function ri(...e){return s(e.length,1),r()}function ui(...e){return s(e.length,1),r()}function pi(...e){return s(e.length,1),r()}function yi(...e){return s(e.length,1),r()}function ai(...e){return s(e.length,1),r()}function ii(...e){return s(e.length,1),r()}function di(...e){return s(e.length,1),r()}function li(...e){return s(e.length,1),r()}function Ni(...e){return s(e.length,1),r()}function ci(...e){return s(e.length,1),r()}function mi(...e){return s(e.length,1),r()}function Ai(...e){return s(e.length,1),r()}function fi(...e){return s(e.length,1),r()}function hi(...e){return s(e.length,1),r()}function gi(...e){return s(e.length,1),r()}function vi(...e){return s(e.length,1),r()}function ms(...e){return s(e.length,1),r()}function As(...e){return s(e.length,1),r()}function fs(...e){return s(e.length,1),r()}function hs(...e){return s(e.length,1),r()}function xi(...e){return s(e.length,1),r()}function bi(...e){return s(e.length,1),r()}function Ci(...e){return s(e.length,1),r()}function Si(...e){return s(e.length,1),r()}function Ei(...e){return s(e.length,1),r()}function wi(...e){return s(e.length,1),r()}function Mi(...e){return s(e.length,1),r()}function Ti(...e){return s(e.length,1),r()}function Di(...e){return s(e.length,1),r()}function Vi(...e){return s(e.length,1),r()}function Pi(...e){return s(e.length,1),r()}function Li(...e){return s(e.length,1),r()}function Fi(...e){return s(e.length,1),r()}function Ii(...e){return s(e.length,1),r()}function ki(...e){return s(e.length,1),r()}function Ri(...e){return s(e.length,1),r()}function Bi(...e){return s(e.length,1),r()}function Ui(...e){return s(e.length,1),r()}function qi(...e){return s(e.length,1),r()}function Ki(...e){return s(e.length,1),r()}function Oi(...e){return s(e.length,1),r()}function Gi(...e){return s(e.length,1),r()}function Wi(...e){return s(e.length,1),r()}function ji(...e){return s(e.length,1),r()}function $i(...e){return s(e.length,1),r()}function _i(...e){return s(e.length,1),r()}function Hi(...e){return s(e.length,1),r()}function Qi(...e){return s(e.length,1),r()}function zi(...e){return s(e.length,1),r()}function Ji(...e){return s(e.length,1),r()}function Yi(...e){return s(e.length,1),r()}function Xi(...e){return s(e.length,1),r()}function Zi(...e){return s(e.length,1),r()}function ed(...e){return s(e.length,1),r()}function td(...e){return s(e.length,1),r()}function od(...e){return s(e.length,1),r()}function sd(...e){return s(e.length,1),r()}function nd(...e){return s(e.length,1),r()}function rd(...e){return s(e.length,1),r()}function ud(...e){return s(e.length,1),r()}function pd(...e){return s(e.length,1),r()}function yd(...e){return s(e.length,1),r()}function ad(...e){return s(e.length,1),r()}function id(...e){return s(e.length,1),r()}function dd(...e){return s(e.length,1),r()}function ld(...e){return s(e.length,1),r()}function Nd(...e){return s(e.length,1),r()}function cd(...e){return s(e.length,1),r()}function md(...e){return s(e.length,1),r()}function Ad(...e){return s(e.length,1),r()}function fd(...e){return s(e.length,1),r()}function hd(...e){return s(e.length,1),r()}function gd(...e){return s(e.length,1),r()}function vd(...e){return s(e.length,1),r()}function xd(...e){return s(e.length,1),r()}function bd(...e){return s(e.length,1),r()}function Cd(...e){return s(e.length,1),r()}function Sd(...e){return s(e.length,1),r()}function Ed(...e){return s(e.length,1),r()}function wd(...e){return s(e.length,1),r()}function Md(...e){return s(e.length,1),r()}function Td(...e){return s(e.length,1),r()}function Dd(...e){return s(e.length,1),r()}function Vd(...e){return s(e.length,1),r()}function Pd(...e){return s(e.length,1),r()}function Ld(...e){return s(e.length,1),r()}function Fd(...e){return s(e.length,1),r()}function Id(...e){return s(e.length,1),r()}function kd(...e){return s(e.length,1),r()}function Rd(...e){return s(e.length,1),r()}function Bd(...e){return s(e.length,1),r()}function Ud(...e){return s(e.length,1),r()}function qd(...e){return s(e.length,1),r()}function Kd(...e){return s(e.length,1),r()}function Od(...e){return s(e.length,1),r()}function Gd(...e){return s(e.length,1),r()}function Wd(...e){return s(e.length,1),r()}function jd(...e){return s(e.length,1),r()}function $d(...e){return s(e.length,1),r()}function _d(...e){return s(e.length,1),r()}function Hd(...e){return s(e.length,1),r()}function Qd(...e){return s(e.length,1),r()}function zd(...e){return s(e.length,1),r()}function Jd(...e){return s(e.length,1),r()}function Yd(...e){return s(e.length,1),r()}function Xd(...e){return s(e.length,1),r()}function Zd(...e){return s(e.length,1),r()}function el(...e){return s(e.length,1),r()}function tl(...e){return s(e.length,1),r()}function ol(...e){return s(e.length,1),r()}function sl(...e){return s(e.length,1),r()}function nl(...e){return s(e.length,1),r()}function rl(...e){return s(e.length,1),r()}function ul(...e){return s(e.length,1),r()}function pl(...e){return s(e.length,1),r()}function yl(...e){return s(e.length,1),r()}function al(...e){return s(e.length,1),r()}function il(...e){return s(e.length,1),r()}function dl(...e){return s(e.length,1),r()}function ll(...e){return s(e.length,1),r()}function Nl(...e){return s(e.length,1),r()}function cl(...e){return s(e.length,1),r()}function ml(...e){return s(e.length,1),r()}function Al(...e){return s(e.length,1),r()}function fl(...e){return s(e.length,1),r()}function gl(e){j(e),f(e.value.length,2,3);let t=e.value[0];if(q(t),t.value!=="try"&&t.value!=="try*")throw new Error("use `try` or `try*` in try/catch expressions");if(m(e.value[1]),e.value[2]){j(e.value[2]),s(e.value[2].value.length,3),q(e.value[2].value[0]);let o=e.value[2].value[0];if(o.value!=="catch"&&o.value!=="catch*")throw new Error("use `catch` or `catch*` in try/catch expressions");q(e.value[2].value[1]),m(e.value[2].value[2])}}function vl(e){j(e),s(e.value.length,3),q(e.value[0]);let t=e.value[0];if(t.value!=="def!"&&t.value!=="globalThis"&&t.value!=="var")throw new Error("use `def!`, `globalThis`, or `var` in def! expressions");O(e.value[1]),m(e.value[2])}function xl(e){j(e),s(e.value.length,3),q(e.value[0]);let t=e.value[0];if(t.value!=="let*"&&t.value!=="let"&&t.value!=="const")throw new Error("use `let*`, `let`, or `const` in let* expressions");J(e.value[1]),m(e.value[2]),ve(e.value[1].value.length);for(let o=0;o<e.value[1].value.length;o+=2)q(e.value[1].value[o]),m(e.value[1].value[o+1])}function bl(e){j(e),s(e.value.length,2),q(e.value[0]),Ne(e.value[0],"quote"),m(e.value[1])}function Cl(e){let t="quasiquoteexpand";j(e),s(e.value.length,2),q(e.value[0]),Ne(e.value[0],t),m(e.value[1])}function Sl(e){let t="quasiquote";j(e),s(e.value.length,2),q(e.value[0]),Ne(e.value[0],t),m(e.value[1])}function El(e){let t="defmacro!";j(e),s(e.value.length,3),q(e.value[0]),Ne(e.value[0],t),O(e.value[1]),m(e.value[2])}function wl(e){let t="do";j(e),E(e.value.length,1),q(e.value[0]),Ne(e.value[0],t);for(let o of e.value.slice(1))m(o)}function Ml(e){let t="if";j(e),f(e.value.length,3,4),q(e.value[0]),Ne(e.value[0],t),m(e.value[1]),m(e.value[2]),Ce(e.value[3])&&m(e.value[3])}function Tl(e){j(e),s(e.value.length,3),q(e.value[0]);let t=e.value[0];if(!["fn*","function","=>"].includes(t.value))throw new Error("use `fn*`, `function`, of `=>` in fn* expressions");J(e.value[1]),Y(e.value[1].value,ie),m(e.value[2])}function Dl(e){return Xe(e)}function it(e){if(C(e)||k(e))return b([x("quote"),e]);if(!B(e))return e;if(He(e,"unquote"))return e.value[1];let n=b([]);for(let u=e.value.length-1;u>=0;u--){let a=e.value[u];n=He(a,"splice-unquote")?b([x("concat"),a.value[1],n]):b([x("cons"),it(a),n])}return L(e)&&(n=b([x("vec"),n])),n}function Vl(e,t){if(!D(e)||!(e.value[0]instanceof ie))return!1;let o=e.value[0],n=t.findEnv(o);if(!Ce(n))return!1;let u=n.get(o);return K(u)?u.isMacro:!1}function gs(e,t){let o=e;for(;Vl(o,t);){let n=o,u=n.value[0];o=t.get(u).value(...n.value.slice(1))}return o}function at(e,t){if(k(e))return t.get(e);if(L(e)){let o=e.value.map(n=>Q(n,t));return A(o)}if(D(e)){let o=e.value.map(n=>Q(n,t));return b(o)}if(C(e)){let o=new Map;for(let[n,u]of e.value.entries())o.set(n,Q(u,t));return T(o)}if(ne(e)){let o=e.value,n=Array.from(e.attributes).reduce((a,[l,v])=>a.set(l,Q(v,t)),new Map),u=e.children.map(a=>Q(a,t));return ge(o,n,u)}return e}function Q(e,t){for(;;){if(D(e)===!1)return at(e,t);if(e.value.length===0)return e;if(e=gs(e,t),D(e)===!1)return at(e,t);if(e.value.length===0)return e;let o=k(e.value[0])?e.value[0].value:"goto_default_clause",n;switch(o){case"var":case"def!":{n=Pl(e,t);break}case"let":case"const":case"let*":{n=Ll(e,t);break}case"quote":{n=Fl(e,t);break}case"quasiquoteexpand":{n=Il(e,t);break}case"quasiquote":{n=kl(e,t);break}case"defmacro!":{n=Rl(e,t);break}case"macroexpand":{n=ye(gs(e.value[1],t));break}case"try":case"try*":{n=Ul(e,t);break}case"do":{n=Bl(e,t);break}case"if":{n=ql(e,t);break}case"=>":case"function":case"fn*":{n=Kl(e,t);break}default:n=Ol(e,t)}if(n.return)return n.return;e=n.continue.ast,t=n.continue.env}}function Pl(e,t){vl(e);let o=e.value[1],n=e.value[2],u=Q(n,t);return ye(t.set(o,u))}function Ll(e,t){xl(e);let o=e.value[1],n=o.value.length,u=new ue(t);for(let a=0;a<n;a+=2){let l=o.value[a],v=o.value[a+1],P=Q(v,u);u.set(l,P)}return Se(e.value[2],u)}function Fl(e,t){return bl(e),ye(e.value[1])}function Il(e,t){return Cl(e),ye(it(e.value[1]))}function kl(e,t){Sl(e);let o=it(e.value[1]);return Se(o,t)}function Rl(e,t){El(e);let o=e.value[1],n=e.value[2],u=Q(n,t),a=G(u);return K(a)&&(a.isMacro=!0),ye(t.set(o,a))}function Bl(e,t){wl(e);let o=r();for(let n=1;n<e.value.length;n++)o=Q(e.value[n],t);return{continue:{ast:o,env:t},return:void 0}}function Ul(e,t){gl(e);try{return{return:Q(e.value[1],t),continue:void 0}}catch(o){if(!e.value[2])throw o;let n=e.value[2].value[1],u=e.value[2].value[2],a;z(o)?a=o:o instanceof Error?a=N(o.message):a=N(JSON.stringify(o));let l=I(a),v=new ue(t,[n],[l]);return{return:Q(u,v),continue:void 0}}}function ql(e,t){Ml(e);let o=e.value[1],n=Q(o,t);if(n.value!==!1&&n.value!==null){let u=e.value[2];return Se(u,t)}if(e.value[3]!==void 0){let u=e.value[3];return Se(u,t)}return ye(r())}function Kl(e,t){Tl(e);let o=e.value[1].value,n=e.value[2],u=t,l=F((...v)=>{let P=new ue(u,o,v);return Q(n,P)},{ast:n,env:u,parameters:o});return ye(l)}function Ol(e,t){let o=at(e,t);j(o);let n=o.value[0];if(K(n)){let u=o.value.slice(1);if(n.closureMeta){let l=n.closureMeta.ast,v=new ue(n.closureMeta.env,n.closureMeta.parameters,u);return{continue:{ast:l,env:v},return:void 0}}return{return:n.value(...u),continue:void 0}}return{return:n,continue:void 0}}function Gl(e){return R(e,!0)}function me(e,t){return Gl(Q(Dl(e),t))}function vs(){let e=new ue(void 0);for(let[t,o]of ce.ns.entries())e.set(t,o);for(let[t,o]of $e.entries())e.set(t,o);for(let[t,o]of Ze.entries())e.set(t,o);for(let[t,o]of yt.entries())e.set(t,o);return e.set(x("eval"),F((...t)=>(s(t.length,1),Q(t[0],e)))),e.set(x("dump"),F((...t)=>{let o=e.serialize();return console.log(R(o,!0)),r()})),me("(def! not (fn* (a) (if a false true)))",e),me(`(defmacro! cond
      (fn* (& xs)
       (if (gt (count xs) 0) (list 'if (first xs)
                                  (if (gt (count xs) 1) (nth xs 1)
                                      (throw "odd number of forms to cond"))
                                  (cons 'cond (rest (rest xs)))))))`,e),e}var bs="user> ";function Cs(e,t){let o=null;try{o=pe.open(t,"w"),o!==null&&o.puts(e)}catch(n){throw o!==null&&o.close(),new Error(`Error writing to file: ${n}`)}}function dt(...e){s(e.length,1);let t=e[0];d(t);let o=Es(t.value);return o==null?r():N(o)}function Ss(...e){s(e.length,1),d(e[0]);let t=[],[o,n]=xs.readdir(e[0].value);if(+n>0)throw new Error(`Error reading directory: ${n}`);for(let u of o)u==="."||u===".."||t.push(N(u));return A(t)}function et(...e){s(e.length,1);let t=e[0];d(t);let o=pe.loadFile(t.value);if(o===null)throw new Error("No such file or directory. xxx");return N(o)}function lt(...e){s(e.length,2);let t=e[0];d(t);let o=e[1];return d(o),Cs(o.value,t.value),r()}function Es(e=bs){pe.out.puts(e);let t=pe.in.getline()?.trim();console.log(t),console.log(e)}function*ws(e=bs){for(;;){pe.out.puts(e);let t=pe.in.getline()?.trim();t&&(yield t)}}function Ms(e){return function(...o){s(o.length,1),d(o[0]);let n=et(o[0]);d(n);let u=new ue(e),a=me(`(do ${n.value})
nil`,u);return N(a)}}function Ts(){let e=vs(),t=Ms(e),o=[["readFile",et],["slurp",et],["load-file",t],["import",t],["readln",dt],["prompt",dt],["readir",Ss],["spit",lt],["writeFile",lt]];for(let[n,u]of o)e.set(x(n),F(u));return e}function Ds(e=""){return e.replace(/\\/g,"/")}async function Wl(...e){let t=Ts(),o=Ds(e[0]),n=e.slice(1).map(u=>N(u));if(t.set(x("*ARGV*"),b(n)),t.set(x("*host-language*"),N("Ensemble")),o){me(`(import "${o}")`,t);return}me('(println (str "Welcome to " *host-language* "! Press Ctrl/Cmd+C to exit."))',t);for await(let u of ws("user> "))if(!(u===""||u===null))try{let a=me(u,t);console.log(a)}catch(a){z(a)?console.log(`error: ${R(a,!1)}`):a instanceof Error&&console.log(a)}}var Vs={displayPrompt:Es,initMain:Ts,loadFileWithEnv:Ms,main:Wl,readir:Ss,readline:ws,readln:dt,rep:me,slurp:et,spit:lt,toPosixPath:Ds,writeToFile:Cs};Vs.main(...scriptArgs);
