var Gs=Object.defineProperty;var Ws=(e,t)=>{for(var o in t)Gs(e,o,{get:t[o],enumerable:!0})};import*as Fs from"os";import*as ie from"std";var P={};Ws(P,{AstNode:()=>W,AtomNode:()=>Fe,BooleanNode:()=>Le,DomNode:()=>we,ErrorNode:()=>ve,ErrorTypes:()=>ye,FunctionNode:()=>ke,KeywordNode:()=>Ie,ListNode:()=>ge,MapNode:()=>Re,NilNode:()=>qe,NumberNode:()=>re,StringNode:()=>ce,SymbolNode:()=>le,VectorNode:()=>xe,assertArgumentCount:()=>s,assertAstNode:()=>f,assertAtomNode:()=>M,assertBooleanNode:()=>_s,assertDefined:()=>Ue,assertDomNode:()=>Qs,assertEq:()=>Js,assertEqual:()=>vt,assertErrorNode:()=>Be,assertEvenArgumentCount:()=>Ce,assertFunctionNode:()=>T,assertGreaterThanEqual:()=>on,assertIsOneOf:()=>en,assertKeywordNode:()=>zs,assertListNode:()=>Q,assertMapKeyNode:()=>G,assertMapNode:()=>$,assertMetadataType:()=>ze,assertMinimumArgumentCount:()=>D,assertNilNode:()=>st,assertNullOrUndefined:()=>Xs,assertNumberNode:()=>p,assertRegExp:()=>pe,assertSequential:()=>J,assertSequentialValues:()=>te,assertStringNode:()=>d,assertSymWithValue:()=>me,assertSymbol:()=>nt,assertSymbolNode:()=>O,assertTrue:()=>Zs,assertUndefined:()=>Ys,assertVariableArgumentCount:()=>h,assertVectorNode:()=>g,continueResult:()=>Me,convertMapKeyToString:()=>ne,convertStringToMapKey:()=>ut,copy:()=>H,copyAtomNode:()=>gt,copyBooleanNode:()=>xt,copyDomNode:()=>Ct,copyErrorNode:()=>St,copyFunctionNode:()=>Et,copyKeywordNode:()=>wt,copyListNode:()=>Tt,copyMapNode:()=>bt,copyNilNode:()=>Mt,copyNumberNode:()=>Dt,copyStringNode:()=>Pt,copySymbolNode:()=>Vt,copyVectorNode:()=>Ft,createAtomNode:()=>q,createBooleanNode:()=>m,createDomNode:()=>be,createDomNodeFromHtmlElement:()=>rt,createErrorNode:()=>N,createFunctionNode:()=>k,createInvalidElementError:()=>_,createKeywordNode:()=>Ne,createListNode:()=>S,createMapNode:()=>V,createNilNode:()=>r,createNumberNode:()=>a,createStringNode:()=>c,createSymbolNode:()=>C,createVectorNode:()=>A,deleteMapElement:()=>Ke,getBareMapKey:()=>De,getMapElement:()=>We,getMapKeys:()=>je,getMapValues:()=>sn,hasMapElement:()=>Ge,htmlEncode:()=>rn,isAstNode:()=>b,isAstTruthy:()=>$e,isAtomNode:()=>Z,isBooleanNode:()=>se,isDefined:()=>Te,isDomNode:()=>ue,isEqualTo:()=>oe,isErrorNode:()=>ee,isFunctionNode:()=>K,isKeywordNode:()=>z,isListNode:()=>F,isMapKeyNode:()=>ht,isMapNode:()=>E,isNilNode:()=>L,isNumberNode:()=>x,isSameClass:()=>ft,isSequentialNode:()=>j,isStringNode:()=>w,isSymbolNode:()=>B,isTypedVector:()=>tn,isVectorNode:()=>I,listStartsWithSymbol:()=>Je,mapFlat:()=>Ye,normalizeWhitespace:()=>un,returnResult:()=>ae,setMapElement:()=>Oe,slash:()=>He,splitAtFirstDot:()=>nn,toAst:()=>y,toErrorNode:()=>yn,unwrap:()=>Y,unwrapAtomNode:()=>Lt,unwrapBooleanNode:()=>kt,unwrapDomNode:()=>pn,unwrapErrorNode:()=>It,unwrapFunctionNode:()=>Rt,unwrapKeywordNode:()=>qt,unwrapListNode:()=>Bt,unwrapMapNode:()=>Qe,unwrapNilNode:()=>Ut,unwrapNumberNode:()=>de,unwrapStringNode:()=>Se,unwrapSymbolNode:()=>$t,unwrapVectorNode:()=>Ot,validTypesString:()=>Pe});var js="atom, boolean, DOM, error, function, keyword, list, map, null, number, string, symbol, or vector",W=class{static kind;line=0;column=0;setPosition(t=0,o=0){return this.line=t,this.column=o,this}getPosition(){return{line:this.line,column:this.column}}},Fe=class e extends W{constructor(o){super();this.value=o}static kind="Atom";get kind(){return e.kind}},Le=class e extends W{constructor(o){super();this.value=o}static kind="Boolean";get kind(){return e.kind}},we=class e extends W{constructor(o,n=new Map,u=[],i){super();this.value=o;this.attributes=n;this.children=u;this.metadata=i}static kind="DOM";line=0;column=0;get kind(){return e.kind}},ye=(v=>(v.Error="Error",v.AggregateError="AggregateError",v.RangeError="RangeError",v.ReferenceError="ReferenceError",v.SyntaxError="SyntaxError",v.TypeError="TypeError",v.URIError="URIError",v))(ye||{}),Hs=["Error","AggregateError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],ve=class e extends W{constructor(o,n,u=r()){super();this.value=o;n!==void 0&&e.isErrorName(n)&&(this.name=n),u!==void 0&&(this.cause=u)}static kind="Error";name=c("Error");cause;get kind(){return e.kind}static isErrorName(o){let n=o.value;return Hs.includes(n)}static assertErrorName(o){if(!e.isErrorName(o))throw N("Error type must be 'Error', 'AggregateError', 'RangeError', 'ReferenceError', 'SyntaxError', 'TypeError', or 'URIError'.","TypeError",o)}toString(){let o=this.cause?this.cause:r(),n=this.name.value,u=w(this.value)?this.value.value:String(this.value);return`<error ${`<str "${n}: [${o.line}:${o.column}]" ${u}>`}>`}},ke=class e extends W{constructor(o,n,u=!1,i){super();this.value=o;this.closureMeta=n;this.isMacro=u;this.metadata=i}static kind="Function";get kind(){return e.kind}},Ie=class e extends W{constructor(o){super();this._value=o;this._value=o.replaceAll(":","")}static kind="Keyword";get kind(){return e.kind}get value(){return`${this._value}:`}set value(o){this._value=`${o.replaceAll(":","")}:`}get bare(){return this._value}},ge=class e extends W{constructor(o,n){super();this.value=o;this.metadata=n}static kind="List";get kind(){return e.kind}},Re=class e extends W{constructor(o=new Map,n){super();this.value=o;this.metadata=n}static kind="Map";get kind(){return e.kind}},qe=class e extends W{constructor(o=null){super();this.value=o}static kind="Null";get kind(){return e.kind}},re=class e extends W{constructor(o){super();this.value=o}static kind="Number";get kind(){return e.kind}},le=class e extends W{constructor(o){super();this.value=o}static kind="Symbol";get kind(){return e.kind}},ce=class e extends W{constructor(o){super();this.value=o}static kind="String";get kind(){return e.kind}},xe=class e extends W{constructor(o,n){super();this.value=o;this.metadata=n}static kind="Vector";get kind(){return e.kind}};function Qs(e){if(!ue(e))throw _(e)}function f(e){if(!b(e))throw _(e)}function M(e){if(!Z(e))throw _(e)}function _s(e){if(!se(e))throw _(e)}function $(e){if(!E(e))throw _(e)}function Be(e){if(!ee(e))throw _(e)}function T(e){if(!K(e))throw _(e)}function zs(e){if(!z(e))throw _(e)}function Q(e){if(!F(e))throw _(e)}function st(e){if(!L(e))throw _(e)}function p(e){if(!x(e))throw _(e)}function d(e){if(!w(e))throw _(e)}function O(e){if(!B(e))throw _(e)}function g(e){if(!I(e))throw _(e)}function pe(e){if(!(e instanceof RegExp))throw N("Expected a regular expression.","TypeError")}function nt(e){if(typeof e!="symbol")throw N("Expected a symbol.","TypeError")}function be(e,t,o,n){return new we(e,t,o,n)}function rt(e){let t=e.tagName.toLowerCase(),o=new Map;for(let u of e.getAttributeNames()){let i=e.getAttribute(u);o.set(u,i?c(i):r())}return new we(t,o)}function q(e){return new Fe(e)}function m(e){return new Le(e)}function V(e,t){return new Re(e,t)}function N(e="Error",t="Error",o=r()){let n=typeof e=="string"?c(e):e,u=c(t),i=b(o)?o:r();return new ve(n,u,i)}function _(e){let t=b(e)?`Invalid ${e.kind} element`:"Invalid element";return N(t,"TypeError",e)}function k(e,t,o=!1,n){return new ke(e,t,o,n)}function Ne(e){return new Ie(e)}function S(e,t){return new ge(e,t)}function r(e){return new qe(e)}function a(e){return new re(e)}function c(e){return new ce(e)}function C(e){return new le(e)}function A(e=[],t){return new xe(e,t)}function ue(e){return e instanceof we}function b(e){return Z(e)||se(e)||ue(e)||ee(e)||K(e)||z(e)||F(e)||E(e)||L(e)||x(e)||w(e)||B(e)||I(e)}function Z(e){return e instanceof Fe}function se(e){return e instanceof Le&&typeof e.value=="boolean"}function E(e){return e instanceof Re&&e.value instanceof Map}function ee(e){return e instanceof ve&&b(e.value)}function K(e){return e instanceof ke&&typeof e.value=="function"}function z(e){return e instanceof Ie&&typeof e.value=="string"&&e.value.endsWith(":")}function F(e){return e instanceof ge}function L(e){return e instanceof qe&&e.value===null}function x(e){return e instanceof re&&typeof e.value=="number"}function w(e){return e instanceof ce&&typeof e.value=="string"}function B(e){return e instanceof le&&typeof e.value=="string"}function I(e){return e instanceof xe&&e.value.every(b)}function ft(e,t){return Object.getPrototypeOf(e)===Object.getPrototypeOf(t)}function Js(e,t){if(!oe(e,t))throw N("Expected values to be equal but got unequal values","TypeError",e)}function Ue(e){if(e===void 0)throw N("Expected value to be defined but got an undefined value","TypeError",b(e)?e:r())}function Ys(e){if(e!==void 0)throw N("Expected value to be undefined but got a defined value","TypeError",b(e)?e:r())}function Xs(e,t){if(e!=null)throw N("Expected value to be null or undefined but got a defined value","TypeError",t)}function Te(e){return e!==void 0}function Zs(e){if(e===!1)throw N("Expected value to be true but got false","TypeError",b(e)?e:r())}function $e(e,t=!1){if(se(e))return e.value;let o=e;return Z(o)?b(o.value)?$e(o.value):!!o.value:L(e)?!1:x(e)?t?!!e.value:!0:!!e.value}function j(e){return F(e)||I(e)}function J(e){if(!F(e)&&!I(e)){let t=b(e)?e.kind:"unknown";throw N(`Expected a list or vector type but got ${t.toLowerCase()}`,"TypeError",b(e)?e:r())}}function G(e){if(!(w(e)||B(e)||z(e))){let t=b(e)?e.kind:"unknown";throw N(`Expected a map key of type string, symbol, or keyword but got ${t}`,"TypeError",b(e)?e:r())}}function ht(e){return w(e)||B(e)||z(e)}function ze(e){if(!K(e)&&!F(e)&&!I(e)&&!E(e)&&!ue(e)){let t=b(e)?e.kind:"unknown";throw N(`Expected a metadata type of function, list, vector or map but got ${t}`,"TypeError",b(e)?e:r())}}function s(e,t,o=r()){if(e!==t){let n=t-e===1?"":"s",u=`Expected ${t} argument${n} but got ${e}`;throw N(u,"TypeError",o)}}function h(e,t,o,n=r()){if(e<t||e>o){let u=`Expected between ${t} and ${o} arguments but got ${e}`;throw N(u,"TypeError",n)}}function D(e,t,o=r()){if(e<t){let n=`Expected at least ${t} arguments but got ${e}`;throw N(n,"TypeError",o)}}function Ce(e,t=r()){if(e%2!==0)throw N("Expected an even number of arguments but got an uneven amount.","TypeError",t)}function te(e,t){for(let o of e)if(!(o instanceof t)){let n=b(o)?o.kind:"unknown";throw N(`Expected all values to be of type ${t.kind}, but got ${n}`,"TypeError",e[0]?e[0]:r())}}function en(e,t){if(!t.some(o=>e instanceof o)){let o=t.map(n=>n.kind).join(", ");throw N(`Expected one of type ${o} but got an invalid type`,"TypeError",e)}}function tn(e,t){return e.value.every(o=>o instanceof t)}function oe(e,t){if(j(e)&&j(t)){if(e.value.length!==t.value.length)return m(!1);for(let n=0;n<e.value.length;n++)if(!oe(e.value[n],t.value[n]).value)return m(!1);return m(!0)}if(E(e)&&E(t)){if(e.value.size!==t.value.size)return m(!1);for(let[n,u]of e.value){let i=t.value.get(n);if(i===void 0||!oe(u,i).value)return m(!1)}return m(!0)}if(Z(e)&&Z(t))return b(e.value)&&b(t.value)?oe(e.value,t.value):m(e.value===t.value);if(!ft(e,t))return m(!1);let o=e.value===t.value;return m(o)}function Je(e,t){let o=F(e)&&B(e.value[0]);return o&&t!==void 0?e.value[0].value===t:o}function vt(e,t){if(e!==t)throw N(`Expected a value of ${t} but got ${e}`,"Error")}function on(e,t){if(e>=t)throw N(`Expected value to be greater than or equal to ${t} but got ${e}`,"Error")}function me(e,t){vt(e.value,t)}function Me(e,t){return{continue:{ast:e,env:t},return:void 0}}function ae(e){return{continue:void 0,return:e}}function H(e){if(Z(e))return gt(e);if(se(e))return xt(e);if(E(e))return bt(e);if(ee(e))return St(e);if(K(e))return Et(e);if(z(e))return wt(e);if(F(e))return Tt(e);if(L(e))return Mt(e);if(x(e))return Dt(e);if(w(e))return Pt(e);if(B(e))return Vt(e);if(I(e))return Ft(e);if(ue(e))return Ct(e);throw N("Expected a value of type atom, boolean, map, DOM, error, functiom, keyword, list, null, number, string, symbol, or vector, but did not find a match.","TypeError",e)}function gt(e){return q(H(e.value))}function xt(e){return m(e.value)}function bt(e){let t=V(new Map(e.value));return t.metadata=H(e.metadata??r()),t}function Ct(e){let t=e.value,o=e.attributes,n=e.children,u=be(t,new Map(o),n.map(H));return u.metadata=H(e.metadata??r()),u}function St(e){return N(H(e.value))}function Et(e){let t=k(e.value);if(t.isMacro=e.isMacro,t.metadata=H(e.metadata??r()),e.closureMeta){let o=e.closureMeta;t.closureMeta={ast:H(o.ast),env:o.env,parameters:o.parameters.map(n=>C(n.value))}}return t}function wt(e){return Ne(e.value)}function Tt(e){let t=S(e.value.map(o=>H(o)));return t.metadata=H(e.metadata??r()),t}function Mt(e){return r()}function Dt(e){return a(e.value)}function Pt(e){return c(e.value)}function Vt(e){return C(e.value)}function Ft(e){let t=A(e.value.map(o=>H(o)));return t.metadata=H(e.metadata??r()),t}function Oe(e,t,o){e.set(ne(t),o)}function Ke(e,t){e.delete(ne(t))}function Ge(e,t){return e.has(ne(t))}function We(e,t){return e.get(ne(t))}function je(e){let t=[];for(let o of e.keys())t.push(ut(o));return S(t)}function ne(e){let t=e;if(z(t))return t.value;let o=e;return w(o)?`"${o.value}"`:e.value}function ut(e){return e.endsWith(":")?Ne(e):e.startsWith('"')?c(e.slice(1,-1)):C(e)}function De(e){let t=ht(e)?e.value:e;return t.endsWith(":")?t.replaceAll(":",""):t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t}function sn(e){let t=[...e.values()];return S(t)}function Ye(e){let t=[];for(let[o,n]of e.entries())t.push(ut(o),n);return t}function nn(e){let t=e.indexOf(".");return[e.slice(0,t),e.slice(t+1)]}function rn(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&apos;")}function un(e){return e.replaceAll(`
`," ").replaceAll(/\s{2,}/g," ")}function He(e){return e.replaceAll("\\","\\\\").replaceAll('"','\\"').replaceAll(`
`,"\\n")}function Y(e){if(Z(e))return Lt(e);if(se(e))return kt(e);if(E(e))return Qe(e);if(ee(e))return It(e);if(K(e))return Rt(e);if(z(e))return qt(e);if(F(e))return Bt(e);if(L(e))return Ut();if(x(e))return de(e);if(w(e))return Se(e);if(B(e))return $t(e);if(I(e))return Ot(e);throw N(`Could not unwrap value. Expected a value of type ${js}, but did not find a match.`,"TypeError",e)}function Lt(e){return Y(e.value)}function kt(e){return e.value}function pn(e){return e.value}function It(e){let t=w(e.value)?e.value.value:String(Y(e.value));return new Error(t)}function Rt(e){return t=>y(Y(e.value(t)))}function qt(e){return e.value}function Bt(e){return e.value.map(Y)}function Qe(e){let t={};for(let[o,n]of e.value.entries())t[o]=Y(n);return t}function Ut(){return null}function de(e){return e.value}function Se(e){return e.value}function $t(e){return e.value}function Ot(e){return e.value.map(Y)}var Pe="array, boolean, error, function, keyword, map, null, number, object, string, symbol, or undefined";function y(e){if(b(e))return e;switch(typeof e){case"undefined":return r();case"number":return a(e);case"string":return e.startsWith('"')?c(e):e.startsWith(":")?Ne(e):C(e);case"boolean":return m(e);case"symbol":return c(JSON.stringify(e));case"function":return k(t=>{try{return y(e(t.map(o=>o.value)))}catch(o){return o instanceof Error?N(c(o.message)):N(c(JSON.stringify(o)))}});case"object":{if(e instanceof Error)return N(c(e.message));if(e===null)return r();if(Array.isArray(e)){let n=e.map(u=>y(u));return S(n)}if(e instanceof Map){let n=new Map;for(let[u,i]of e.entries()){let l=String(u),v=y(i);n.set(l,v)}return V(n)}let t=e,o=new Map;for(let[n,u]of Object.entries(t)){let i=String(n),l=y(u);o.set(i,l)}return V(o)}default:{let t=String(e);return N(c(`Expected value of type ${Pe} but got unknown type ${t}`))}}}function yn(e){return ee(e)?e:b(e)?N(e):e instanceof Error?N(c(e.message)):N(c(String(e)))}function U(e,t=!1){if(w(e))return t?`"${He(e.value)}"`:e.value;if(z(e)||se(e)||x(e)||B(e))return String(e.value);let o=e;if(Z(o)){if(b(o.value))return`<atom ${U(o.value)}>`;if(o.value instanceof HTMLElement){let n=rt(o.value);return`<atom <element ${U(n)}>>`}return o.value instanceof Event?`<atom <event ${o.value.type}>>`:`<atom #<js ${typeof o.value}>>`}if(ee(e)){let n=e.cause?e.cause:r();return`<error ${`<str "${e.name.value}: [${n.line}:${n.column}]" ${U(e.value,t)}>`}>`}if(K(e))return"#<fn>";if(j(e)){let n=F(e),u=e.value.map(i=>U(i,t)).join(" ");return n?`(${u})`:`[${u}]`}if(ue(e))return Ee(e,t);if(E(e))return`{${Ye(e.value).map(u=>U(u,t)).join(" ")}}`;if(L(e))return"nil";throw N(`Expected type of ${Pe} but got ${JSON.stringify(e)}`,"TypeError",e)}var an=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]);function Ee(e,t=!1){if(ue(e)){let n=e.value,u=an.has(n),i="";if(e.attributes.size>0&&(i=` ${Array.from(e.attributes).map(([v,R])=>v==="style"?cn(R,t):`${De(v)}="${Ee(R,t)}"`).join(" ")}`),u)return`<${n}${i} />`;let l=[];if(e.children.length>0){let v=[];n==="style"?v=e.children.map(R=>ln(R,t)):n==="script"?v=e.children.map(R=>dn(R,t)):v=e.children.map(R=>Ee(R,t)),l.push(v.join(" "))}return n==="!doctype"?`<!doctype html>
${l.join(" ")}`:`<${n}${i}>${l.join(" ")}</${n}>`}if(w(e))return t?`"${He(e.value)}"`:e.value;if(z(e)||se(e)||x(e)||B(e))return String(e.value);let o=e;if(Z(o))return`<atom ${Ee(o.value)}>`;if(ee(e))return Ee(e.value,t);if(K(e))return"#<fn>";if(j(e)){let n=F(e),u=e.value.map(i=>Ee(i,t)).join(" ");return n?`<${u}>`:`[${u}]`}if(E(e))return`{${Ye(e.value).map(u=>Ee(u,t)).join(" ")}}`;if(L(e))return"nil";throw N(`Expected type of ${Pe} but got ${JSON.stringify(e)}`,"TypeError",e)}function dn(e,t=!1){return`
import { rep, initEnv } from '../../bin/ensemble.js';
rep(\`${U(e,!0)}\`, initEnv());
`}function Ve(e,t=!1){if(w(e))return t?He(e.value):e.value;if(z(e))return e.value.slice(1);if(x(e))return String(e.value);if(B(e))return e.value;if(ee(e))return Ve(e.value,t);if(F(e)||I(e))return e.value.map(o=>Ve(o,t)).join(" ");if(E(e))return[...e.value].map(([o,n])=>{let u=De(o);return L(n)?u:E(n)?`${u} {${Ve(n,t)}}`:`${De(o)}: ${Ve(n,t)};`}).join(" ");if(se(e)||Z(e)||K(e)||ue(e)||L(e))return"";throw N(`Expected type of ${Pe} but got ${JSON.stringify(e)}`,"TypeError",e)}function ln(e,t=!1){return Ve(e,t)}function cn(e,t=!1){return E(e)?Nn(e,t):"{}"}function Nn(e,t=!1){return[...e.value].map(([o,n])=>`${De(o)}: ${Ve(n,t)};`).join("")}var mn=/[\s,=]*(~@|[[\]{}()'`~^@<>]|"(?:\\.|[^\\"])*"?|;.*|\/\/.*|\r?\n|[^\s[\]{}<>('"`,;=)]*)/g,An=/^-?\d+(\.\d+)?$/,fn=/"(?:\\.|[^\\"])*"/,pt=class{constructor(t,o=0){this.tokens=t;this.position=o}line=0;next=()=>this.tokens[this.position++];peek=()=>this.tokens[this.position];context=()=>{let t=this.position-10,o=this.position+10;return this.tokens.slice(t,o).join(" ")}};function hn(e){return[...e.matchAll(mn)].filter(o=>!o[1].startsWith(";")&&!o[1].startsWith("//")&&o[1]!=="").map(o=>o[1])}function et(e){try{let t=hn(e);return t.length===0?r():it(new pt(t))}catch(t){throw t}}function it(e){let t=e.peek();if(t===void 0)throw N("EOF","SyntaxError").setPosition(e.line,e.position);switch(t){case`
`:case`\r
`:return e.line++,e.next(),it(e);case")":case"]":case"}":case">":throw N(`Unexpected '${t}'`,"SyntaxError").setPosition(e.line,e.position);case"(":return Ze(e,")");case"[":return Ze(e,"]");case"{":return Ze(e,"}");case"<":return Ze(e,">");default:return vn(e)}}function vn(e){let t=e.next();if(t===void 0)throw N("Unexpected end of file","SyntaxError").setPosition(e.line,e.position);if(t==="nil"||t==="null")return r().setPosition(e.line,e.position);if(t==="false")return m(!1).setPosition(e.line,e.position);if(t==="true")return m(!0).setPosition(e.line,e.position);if(An.test(t))return a(Number.parseFloat(t)).setPosition(e.line,e.position);if(fn.test(t))return c(gn(t)).setPosition(e.line,e.position);if(t.startsWith(":")||t.endsWith(":"))return Ne(t).setPosition(e.line,e.position);if(t.startsWith('"'))throw N(`Expected '"' but got end of file`,"SyntaxError").setPosition(e.line,e.position);return C(t).setPosition(e.line,e.position)}function gn(e){return e.slice(1,-1).replaceAll(/\\(.)/g,(t,o)=>o==="n"?`
`:o)}function Ze(e,t){let o=[];for(e.next();;){let n=e.peek();if(n===void 0)throw N(`expected '${t}', got EOF`,"SyntaxError").setPosition(e.line,e.position);if(n===t){e.next();break}o.push(it(e))}switch(t){case">":case")":return S(o).setPosition(e.line,e.position);case"]":return A(o).setPosition(e.line,e.position);case"}":{let n=V().setPosition(e.line,e.position);for(let u=0;u<o.length;u+=2){let i=o[u];G(i);let l=o[u+1],v=ne(i);n.value.set(v,l)}return n}default:throw N(`unknown end value: ${t}`,"SyntaxError").setPosition(e.line,e.position)}}var Gt=new Map,Wt=[["eq",jt],["throw",Co],["nil?",Po],["true?",Vo],["false?",Fo],["symbol",at],["Symbol.new",at],["symbol?",ko],["keyword",Io],["keyword?",Ro],["number?",qo],["macro?",Uo],["pr-str",Ht],["str",Qt],["prn",_t],["println",yt],["console.log",yt],["read-string",zt],["string?",Lo],["trim",Jt],["lt",Yt],["lte",Xt],["gt",Zt],["gte",eo],["add",to],["subtract",oo],["multiply",so],["divide",no],["time-ms",ro],["assoc",Go],["contains?",Ho],["dissoc",Wo],["get",jo],["hash-map",dt],["keys",Qo],["map?",Ko],["vals",_o],["list",uo],["list?",po],["apply",So],["fn?",Bo],["concat",yo],["conj",wo],["cons",io],["count",fo],["empty?",Ao],["first",co],["last",No],["join",Jo],["map",Eo],["nth",lo],["rest",mo],["seq",To],["sequential?",zo],["vec",ao],["vector",$o],["vector?",Oo],["meta",Mo],["with-meta",Do],["atom",ho],["atom?",vo],["deref",go],["reset!",xo],["swap!",bo],[".",bn]];for(let[e,t]of Wt)Gt.set(C(e),k(t));function jt(e){return s(e.length,2),oe(e[0],e[1])}function Ht(e){let t=e.map(o=>U(o,!0)).join(" ");return c(t)}function Qt(e){let t=e.map(o=>U(o,!1)).join("");return c(t)}function _t(e){let t=e.map(o=>U(o,!0)).join(" ");return console.log(t),r()}function yt(e){let t=e.map(o=>U(o,!1)).join(" ");return console.log(t),r()}function zt(e){s(e.length,1);let t=e[0];return d(t),et(t.value)}function Jt(e){s(e.length,1);let t=e[0].value;return t?c(t.trim()):c("")}function Yt(e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),m(t.value<o.value)}function Xt(e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),m(t.value<=o.value)}function Zt(e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),m(t.value>o.value)}function eo(e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),m(t.value>=o.value)}function to(e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),a(t.value+o.value)}function oo(e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),a(t.value-o.value)}function so(e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),a(t.value*o.value)}function no(e){s(e.length,2);let t=e[0];p(t);let o=e[1];return p(o),a(t.value/o.value)}function ro(e){return s(e.length,0),a(new Date().getTime())}function uo(e){for(let t of e)f(t);return S(e)}function po(e){return s(e.length,1),m(F(e[0]))}function io(e){return s(e.length,2),J(e[1]),new ge([e[0]].concat(e[1].value))}function yo(e){let t=[];for(let o of e){J(o);for(let n of o.value)t.push(n)}return S(t)}function ao(e){return F(e[0])?A(e[0].value):e[0]}function lo(e){s(e.length,2),J(e[0]),p(e[1]);let t=e[1].value,o=e[0],n=e[0].value.length;if(n>0&&t<n)return o.value[t];throw N(`Expected an nth index greater than zero and less than ${n} but got ${t} out of range`,"RangeError",t)}function co(e){return s(e.length,1),j(e[0])&&e[0].value.length>0?e[0].value[0]:r()}function No(e){return s(e.length,1),j(e[0])&&e[0].value.length>0?e[0].value[e[0].value.length-1]:r()}function mo(e){return s(e.length,1),j(e[0])?S(e[0].value.slice(1)):S([])}function Ao(e){s(e.length,1);let t=e[0];return J(t),m(t.value.length===0)}function fo(e){s(e.length,1);let t=e[0];if(L(t))return a(0);if(E(e[0]))return a(e[0].value.size);if(j(e[0]))return a(e[0].value.length);throw N(`Expected a length argument of type null, map, list, or vector but got ${t.kind}`,"TypeError",t)}function ho(e){s(e.length,1);let t=e[0];return q(t)}function vo(e){s(e.length,1);let t=e[0];return m(Z(t))}function go(e){s(e.length,1);let t=e[0];return M(t),t.value}function xo(e){s(e.length,2);let t=e[0],o=e[1];return M(t),t.value=o,o}function bo(e){D(e.length,2),M(e[0]),T(e[1]);let t=e[0],o=e[1],n=e.slice(2);return t.value=o.value([t.value].concat(n)),t.value}function Co(e){throw s(e.length,1),f(e[0]),N(e[0])}function So(e){let t=e.length;D(t,2),T(e[0]);let o=e[0],n=e[t-1];J(n);let i=e.slice(1,-1).concat(n.value);return o.value(i)}function Eo(e){let t=e.length;s(t,2),T(e[0]),J(e[1]);let o=e[0],u=e[1].value.map(i=>o.value([i]));return S(u)}function wo(e){if(D(e.length,2),J(e[0]),F(e[0])){let n=e[0],u=e.slice(1);return S(u.reverse().concat(n.value))}let t=e[0],o=e.slice(1);return A(t.value.concat(o))}function To(e){s(e.length,1);let t=e[0];return F(t)&&t.value.length>0?t:I(t)&&t.value.length>0?S(t.value):w(t)&&t.value.length>0?S(t.value.split("").map(o=>c(o))):r()}function Mo(e){return s(e.length,1),ze(e[0]),e[0].metadata??r()}function Do(e){s(e.length,2),ze(e[0]),f(e[1]);let t=H(e[0]);return t.metadata=e[1],t}function Po(e){return s(e.length,1),m(L(e[0]))}function Vo(e){return s(e.length,1),m(se(e[0])&&e[0].value)}function Fo(e){return s(e.length,1),m(se(e[0])&&!e[0].value)}function Lo(e){return s(e.length,1),m(w(e[0]))}function at(e){return s(e.length,1),d(e[0]),C(e[0].value)}function ko(e){return s(e.length,1),m(B(e[0]))}function Io(e){s(e.length,1),G(e[0]);let t=e[0];if(z(t))return t;let o=e[0];return Ne(`:${o.value}`)}function Ro(e){return s(e.length,1),m(z(e[0]))}function qo(e){return s(e.length,1),m(x(e[0]))}function Bo(e){return s(e.length,1),m(K(e[0])&&!e[0].isMacro)}function Uo(e){return s(e.length,1),m(K(e[0])?e[0].isMacro:!1)}function $o(e){return A(e)}function Oo(e){return s(e.length,1),m(I(e[0]))}function dt(e){if(e.length===0)return V();if(e.length===1&&E(e[0]))return V(new Map(e[0].value));Ce(e.length);let t=V();for(let o=0;o<e.length;o+=2){let n=e[o];G(n),Oe(t.value,n,e[o+1])}return t}function Ko(e){return s(e.length,1),m(E(e[0]))}function Go(e){D(e.length,1),$(e[0]);let t=e.slice(1),o=V(new Map(e[0].value)),n=dt(t);for(let[u,i]of n.value.entries())o.value.set(u,i);return o}function Wo(e){D(e.length,1),$(e[0]);let t=V(new Map(e[0].value));for(let o of e.splice(1))G(o),Ke(t.value,o);return t}function jo(e){s(e.length,2);let t=e[0];if(!E(t))return r();let o=e[1];G(o);let n=We(t.value,o);return n!==void 0?n:r()}function Ho(e){s(e.length,2);let t=e[0],o=e[1];return $(t),G(o),m(Ge(t.value,o))}function Qo(e){return s(e.length,1),$(e[0]),je(e[0].value)}function _o(e){return s(e.length,1),$(e[0]),S(Array.from(e[0].value.values()))}function zo(e){return m(j(e[0]))}function Jo(e){h(e.length,1,2),J(e[0]);let t=w(e[1])?e[1].value:" ",o=e[0].value.map(n=>U(n,!1)).join(t);return c(o)}function xn(e){D(e.length,2);let t=e[0],o=e.slice(1),n=o.pop();Ue(n),T(n);let u=o.length;for(let i=0;i<u;i++){let l=o[i];if(Q(l),s(l.value.length,2),T(l.value[1]),oe(t,l.value[0]).value)return l.value[1].value([])}return n.value([])}function bn(e){D(e.length,2),f(e[0]),d(e[1]);let t=e[1].value,o=null,n=e[0].value;if(Array.isArray(n)?o=n:n instanceof Map?o=Object.fromEntries(n):n instanceof Set?o=Array.from(n):n!==null&&typeof n=="object"&&(o=n),o===null)return r();let u=t.split(".").reduce((l,v)=>{if(l[v]!==void 0)return l[v]},o);return q(u)}var Ae={add:to,apply:So,applyToSequence:Eo,assoc:Go,atom:ho,concat:yo,conj:wo,cons:io,contains:Ho,deref:go,dissoc:Wo,divide:no,empty:Ao,eq:jt,firstNodeInList:co,get:jo,gt:Zt,gte:eo,hashMap:dt,isAtom:vo,isFalse:Fo,isFn:Bo,isKeyword:Ro,isListNode:po,isMacro:Uo,isMap:Ko,isNil:Po,isNumber:qo,isSequentialNode:zo,isString:Lo,isSymbolNode:ko,isTrue:Vo,isVector:Oo,join:Jo,keys:Qo,keyword:Io,lastNodeInList:No,length:fo,list:uo,lt:Yt,lte:Xt,meta:Mo,multiply:so,ns:Gt,nsValues:Wt,nth:lo,printEscapedString:Ht,printEscapedStringToScreen:_t,printUnescapedString:Qt,printUnescapedStringToScreen:yt,readString:zt,reset:xo,rest:mo,seq:To,subtract:oo,swap:bo,switchCase:xn,symbol:at,throwError:Co,timeMs:ro,trim:Jt,vals:_o,vec:ao,vector:$o,withMeta:Do};var fe=class{value=new Map;outer;binds=[];exprs=[];constructor(t=void 0,o=[],n=[]){this.outer=t,this.binds=o,this.exprs=n;for(let u=0;u<o.length;u++){let i=o[u];if(i.value==="&"){let v=o[u+1];if(v){let R=n.slice(u),Ks=ne(v);this.value.set(Ks,S(R));break}}let l=ne(i);this.value.set(l,n[u])}}serialize(){let t=V(),o=V();this.outer&&(o=this.outer.serialize());let n=this.value.entries();for(let[u,i]of n)t.value.set(u,i);return t}set(t,o){let n=ne(t);return this.value.set(n,o),o}findEnv(t){let o=ne(t);if(this.value.has(o))return this;if(Te(this.outer))return this.outer.findEnv(t)}get(t){let o=this.findEnv(t);if(o===void 0)throw N(`The variable name '${t.value}' has not been declared.`,"ReferenceError",t);let n=ne(t),u=o.value.get(n);return Ue(u),u}};var Sn=new Set(["!doctype","a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","imgmap","input","kbd","label","legend","li","link","main","mark","menu","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","portal","progress","q","rp","rt","ruby","s","samp","script","search","section","select","slot","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"]),tt=new Map;for(let e of Sn)tt.set(C(e),k(En(e)));function En(e){return t=>wn([C(e)].concat(t))}function wn(e){D(e.length,1);let t=e[0];O(t);let o=new Map,n=[];return E(e[1])?(e[1].value.forEach((u,i)=>o.set(i,u)),e.slice(2).forEach(u=>n.push(u))):e.slice(1).forEach(u=>n.push(u)),be(t.value,o,n)}function Tn(e){s(e.length,1),d(e[0]);let t=e[0].value,o=document.querySelector(t);if(o===null)return r();let u=Array.from(o.attributes).reduce((i,l)=>i.set(l.name,c(l.value)),new Map);return be(o.tagName,u,[])}tt.set(C("document.querySelector"),k(Tn));var ts=[["Array",Dn],["Array.from",Yo],["Array.isArray",Vn],["Array.of",Yo],["Array::at",Pn],["Array::concat",Fn],["Array::copyWithin",Ln],["Array::entries",kn],["Array::every",In],["Array::fill",Rn],["Array::filter",qn],["Array::find",Bn],["Array::findIndex",Un],["Array::findLast",$n],["Array::findLastIndex",On],["Array::flat",Kn],["Array::flatMap",Gn],["Array::includes",Wn],["Array::indexOf",jn],["Array::join",Hn],["Array::keys",Qn],["Array::length",Yn],["Array::map",_n],["Array::pop",zn],["Array::push",Jn],["Array::reduce",Xn],["Array::reverse",Xo],["Array::shift",Zn],["Array::slice",er],["Array::some",tr],["Array::sort",Zo],["Array::splice",es],["Array::toReversed",Xo],["Array::toSorted",Zo],["Array::toSpliced",es],["Array::unshift",or],["Array::values",sr],["Array::with",nr],["Array.toString",Ae.printEscapedString]];function Dn(e){if(D(e.length,1),e.length===1&&x(e[0])){let t=Array(e[0].value).fill(r());return A(t)}return A(e)}function Yo(e){h(e.length,1,3),g(e[0]),e.length>=2&&T(e[1]),e.length===3&&f(e[2]);let t=e[0].value;if(e.length===1)return A([...t]);let o=e[1].value,n=t.map((u,i)=>o([u]));return A(n)}function Pn(e){s(e.length,2),g(e[0]),p(e[1]);let t=e[0].value,o=e[1].value,n=t.at(o);return n?y(n):r()}function Vn(e){s(e.length,1),f(e[0]);let t=I(e[0]);return m(t)}function Fn(e){D(e.length,1),te(e,xe);let t=e[0].value.concat(e.slice(1).flatMap(o=>o.value));return A(t)}function Ln(e){h(e.length,1,4),g(e[0]),p(e[1]),p(e[2]);let t=e[0].value,o=e[1].value,n=e[2].value,u=x(e[3])?e[3].value:void 0,i=t.copyWithin(o,n,u);return A(i)}function kn(e){s(e.length,1),g(e[0]);let t=e[0].value.map((o,n)=>{let u=a(n);return A([u,o])});return A(t)}function In(e){s(e.length,2),g(e[0]),T(e[1]);let t=e[0].value,o=e[1].value,n=t.every((u,i,l)=>o([a(i),u,A(l)]).value);return m(n)}function Rn(e){h(e.length,2,4),g(e[0]),f(e[1]);let t=e[0].value.map(Y),o=e[1].value,n;e.length>=3&&(p(e[2]),n=e[2].value);let u;e.length===4&&(p(e[3]),u=e[3].value);let i=t.fill(o,n,u);return A(i.map(y))}function qn(e){s(e.length,2),T(e[0]),g(e[1]);let t=e[0],n=e[1].value.filter(u=>!!t.value([u]).value);return A(n)}function Bn(e){s(e.length,2),g(e[0]),T(e[1]);let t=e[0].value,o=e[1].value;return t.find((u,i,l)=>o([u,a(i),A(l)]).value)??r()}function Un(e){s(e.length,2),g(e[0]),T(e[1]);let t=e[0].value,o=e[1].value,n=t.findIndex((u,i,l)=>o([u,a(i),A(l)]).value);return a(n)}function $n(e){s(e.length,2),g(e[0]),T(e[1]);let t=e[0].value,o=e[1].value;return t.findLast((u,i,l)=>o([u,a(i),A(l)]).value)??r()}function On(e){s(e.length,2),g(e[0]),T(e[1]);let t=e[0].value,o=e[1].value,n=t.findLastIndex((u,i,l)=>o([u,a(i),A(l)]).value);return a(n)}function Kn(e){s(e.length,1),g(e[0]);let t=e[0].value;function o(u){return u.reduce((i,l)=>i.concat(I(l)?o(l.value):l),[])}let n=o(t);return A(n)}function Gn(e){s(e.length,2),g(e[0]),T(e[1]);let t=e[0].value,o=e[1].value;function n(l){return l.reduce((v,R)=>v.concat(I(R)?n(R.value):R),[])}let u=t.map((l,v,R)=>o([l,a(v),A(R)])),i=n(u);return A(i)}function Wn(e){s(e.length,2),g(e[0]),f(e[1]);let t=e[0],o=e[1],n=t.value.some(u=>oe(u,o).value);return m(n)}function jn(e){s(e.length,2),g(e[0]),f(e[1]);let t=e[0],o=e[1];for(let[n,u]of t.value.entries())if(oe(u,o).value)return a(n);return a(-1)}function Hn(e){h(e.length,1,2),J(e[0]);let t=w(e[1])?e[1].value:" ",o=e[0].value.map(n=>U(n,!1)).join(t);return c(o)}function Qn(e){s(e.length,1),g(e[0]);let o=e[0].value.map((n,u)=>a(u));return A(o)}function _n(e){h(e.length,2,3),g(e[0]),T(e[1]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=t.map((i,l,v)=>o([i,a(l),n]));return A(u)}function zn(e){s(e.length,1),g(e[0]);let t=e[0],o=t.value[t.value.length-1];return y(o)}function Jn(e){if(D(e.length,2),!e.every(b))throw new TypeError("Invalid arguments.");return g(e[0]),A([...e[0].value,...e.slice(1)])}function Yn(e){s(e.length,1),g(e[0]);let t=e[0];return a(t.value.length)}function Xn(e){s(e.length,3),T(e[0]),g(e[1]);let t=e[0],o=e[1],n=e[2];for(let u of o.value)n=t.value([n,u]);return n}function Xo(e){s(e.length,1),g(e[0]);let o=e[0].value.toReversed();return A(o)}function Zn(e){s(e.length,1),g(e[0]);let o=e[0].value[0];return o||r()}function er(e){h(e.length,1,3),g(e[0]);let t=0;e[1]!==void 0&&(p(e[1]),t=e[1].value);let o=e[0].value.length;return e[2]!==void 0&&(p(e[2]),o=e[2].value),A(e[0].value.slice(t,o))}function tr(e){s(e.length,2),g(e[0]),T(e[1]);let t=e[0].value,o=e[1].value,n=t.some((u,i,l)=>o([u,a(i),A(l)]).value);return m(n)}function Zo(e){s(e.length,2),g(e[0]),T(e[1]);let t=e[0].value,o=e[1].value,n=t.toSorted((u,i)=>{let l=o([u,i]);return p(l),l.value});return A(n)}function es(e){h(e.length,2,4),g(e[0]),p(e[1]);let t=e[0].value,o=e[1].value;if(e.length<3){let l=t.toSpliced(o);return A(l)}p(e[2]);let n=e[2].value,u=e.slice(3),i=t.toSpliced(o,n,...u);return A(i)}function or(e){s(e.length,2),g(e[1]);let t=[e[0]].concat(e[1].value);return A(t)}function sr(e){s(e.length,1),g(e[0]);let o=e[0].value.map(n=>n);return A(o)}function nr(e){s(e.length,3),g(e[0]),p(e[1]),f(e[2]);let t=e[0],o=e[1],n=e[2],u=t.value.with(o.value,n);return A(u)}var os=[["Boolean",rr]];function rr(e){return s(e.length,1),f(e[0]),m(!!e[0].value)}var ss=[["decodeURI",ur],["decodeURIComponent",pr],["encodeURI",ir],["encodeURIComponent",yr]];function ur(e){s(e.length,1),d(e[0]);let t=decodeURI(e[0].value);return c(t)}function pr(e){s(e.length,1),d(e[0]);let t=decodeURIComponent(e[0].value);return c(t)}function ir(e){s(e.length,1),d(e[0]);let t=encodeURI(e[0].value);return c(t)}function yr(e){s(e.length,1),d(e[0]);let t=encodeURIComponent(e[0].value);return c(t)}var ns=[["Date",ar],["Date.now",dr],["Date.parse",lr],["Date.UTC",cr],["Date.prototype.getDate",Nr],["Date.prototype.getDay",mr],["Date.prototype.getFullYear",Ar],["Date.prototype.getHours",fr],["Date.prototype.getMilliseconds",hr],["Date.prototype.getMinutes",vr],["Date.prototype.getMonth",gr],["Date.prototype.getSeconds",xr],["Date.prototype.getTime",br],["Date.prototype.getTimezoneOffset",Cr],["Date.prototype.getUTCDate",Sr],["Date.prototype.getUTCDay",Er],["Date.prototype.getUTCFullYear",wr],["Date.prototype.getUTCHours",Tr],["Date.prototype.getUTCMilliseconds",Mr],["Date.prototype.getUTCMinutes",Dr],["Date.prototype.getUTCMonth",Pr],["Date.prototype.getUTCSeconds",Vr],["Date.prototype.setDate",Fr],["Date.prototype.setFullYear",Lr],["Date.prototype.setHours",kr],["Date.prototype.setMilliseconds",Ir],["Date.prototype.setMinutes",Rr],["Date.prototype.setMonth",qr],["Date.prototype.setSeconds",Br],["Date.prototype.setTime",Ur],["Date.prototype.setUTCDate",$r],["Date.prototype.setUTCFullYear",Or],["Date.prototype.setUTCHours",Kr],["Date.prototype.setUTCMilliseconds",Gr],["Date.prototype.setUTCMinutes",Wr],["Date.prototype.setUTCMonth",jr],["Date.prototype.setUTCSeconds",Hr],["Date.prototype.toDateString",Qr],["Date.prototype.toISOString",_r],["Date.prototype.toJSON",zr],["Date.prototype.toLocaleDateString",Jr],["Date.prototype.toLocaleString",Yr],["Date.prototype.toLocaleTimeString",Xr],["Date.prototype.toString",Zr],["Date.prototype.toTimeString",eu],["Date.prototype.toUTCString",tu]];function ar(e){let t=e.map(Y),o=t.length>0?new Date(...t):new Date;return a(o.getTime())}function dr(e){return a(Date.now())}function lr(e){s(e.length,1),d(e[0]);let t=Date.parse(e[0].value);return a(t)}function cr(e){let t=e.map(Y),o=Date.UTC(...t);return Number.isNaN(o)?r():a(o)}function Nr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getDate())}function mr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getDay())}function Ar(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getFullYear())}function fr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getHours())}function hr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getMilliseconds())}function vr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getMinutes())}function gr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getMonth())}function xr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getSeconds())}function br(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getTime())}function Cr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getTimezoneOffset())}function Sr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getUTCDate())}function Er(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getUTCDay())}function wr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getUTCFullYear())}function Tr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getUTCHours())}function Mr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getUTCMilliseconds())}function Dr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getUTCMinutes())}function Pr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getUTCMonth())}function Vr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return a(t.getUTCSeconds())}function Fr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setDate(e[1].value),a(t.getTime())}function Lr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setFullYear(e[1].value),a(t.getTime())}function kr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setHours(e[1].value),a(t.getTime())}function Ir(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setMilliseconds(e[1].value),a(t.getTime())}function Rr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setMinutes(e[1].value),a(t.getTime())}function qr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setMonth(e[1].value),a(t.getTime())}function Br(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setSeconds(e[1].value),a(t.getTime())}function Ur(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setTime(e[1].value),a(t.getTime())}function $r(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCDate(e[1].value),a(t.getTime())}function Or(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCFullYear(e[1].value),a(t.getTime())}function Kr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCHours(e[1].value),a(t.getTime())}function Gr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCMilliseconds(e[1].value),a(t.getTime())}function Wr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCMinutes(e[1].value),a(t.getTime())}function jr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCMonth(e[1].value),a(t.getTime())}function Hr(e){s(e.length,2),p(e[0]),p(e[1]);let t=new Date(e[0].value);return t.setUTCSeconds(e[1].value),a(t.getTime())}function Qr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return c(t.toDateString())}function _r(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return c(t.toISOString())}function zr(e){h(e.length,1,2),p(e[0]),e[1]&&d(e[1]);let t=new Date(e[0].value);return c(t.toJSON())}function Jr(e){h(e.length,1,3),p(e[0]);let t=new Date(e[0].value),o=e.slice(1).map(Y);return c(t.toLocaleDateString(...o))}function Yr(e){h(e.length,1,3),p(e[0]);let t=new Date(e[0].value),o=e.slice(1).map(Y);return c(t.toLocaleString(...o))}function Xr(e){h(e.length,1,3),p(e[0]);let t=new Date(e[0].value),o=e.slice(1).map(Y);return c(t.toLocaleTimeString(...o))}function Zr(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return c(t.toString())}function eu(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return c(t.toTimeString())}function tu(e){s(e.length,1),p(e[0]);let t=new Date(e[0].value);return c(t.toUTCString())}var rs=[["Error",ou],["Error.prototype.message",su],["Error.prototype.cause",nu],["Error.prototype.name",ru]];function ou(e){h(e.length,1,3);let t=e[0];d(t);let o;if(e[1]!==void 0){if(!w(e[1])&&!L(e[1]))throw new TypeError("Second argument must be a string or nil.");w(e[1])&&(ve.assertErrorName(e[1]),o=e[1])}let n;return e[2]!==void 0&&(f(e[2]),n=e[2]),N(t,o?o.value:"Error",n)}function su(e){return s(e.length,1),Be(e[0]),e[0].value}function nu(e){return s(e.length,1),Be(e[0]),e[0].cause??r()}function ru(e){return s(e.length,1),Be(e[0]),e[0].name}var ps=[["Function",us],["Function.isFunction",Ae.isFn],["Function.prototype.apply",uu],["Function.prototype.bind",iu],["Function.prototype.call",pu],["js-eval",us]];function us(e){s(e.length,1),d(e[0]);try{let t=new Function(`'use strict'; return (${e[0].value})`)();return y(t)}catch(t){return t instanceof Error?N(c(t.message)):N(c(JSON.stringify(t)))}}function uu(e){s(e.length,2),T(e[0]),g(e[1]);let t=e[0].value.apply(null,[e[1].value]);return y(t)}function pu(e){D(e.length,1),T(e[0]);let t=e[0].value.call(null,e.slice(1));return y(t)}function iu(e){D(e.length,2),T(e[0]),f(e[1]);let t=e[0].value;return k(()=>t([]))}var is=[["Map.isMap",yu],["Map.new",ys],["Map::delete",lu],["Map::entries",au],["Map::get",cu],["Map::has",Nu],["Map::keys",mu],["Map::set",du],["Map::size",fu],["Map::values",Au]];function yu(e){return s(e.length,1),m(E(e[0]))}function ys(e){if(e.length===0)return V();if(e.length===1&&E(e[0]))return V(new Map(e[0].value));Ce(e.length);let t=V();for(let o=0;o<e.length;o+=2){let n=e[o];G(n),Oe(t.value,n,e[o+1])}return t}function au(e){s(e.length,1),$(e[0]);let t=e[0].value.entries(),o=A();for(let[n,u]of t){let i=A([y(n),y(u)]);o.value.push(i)}return o}function du(e){D(e.length,1),$(e[0]);let t=e.slice(1),o=V(new Map(e[0].value)),n=ys(t);for(let[u,i]of n.value.entries())o.value.set(u,i);return o}function lu(e){D(e.length,1),$(e[0]);let t=V(new Map(e[0].value));for(let o of e.splice(1))G(o),Ke(t.value,o);return t}function cu(e){s(e.length,2);let t=e[0];if(!E(t))return r();let o=e[1];G(o);let n=We(t.value,o);return n!==void 0?n:r()}function Nu(e){s(e.length,2);let t=e[0],o=e[1];return $(t),G(o),m(Ge(t.value,o))}function mu(e){return s(e.length,1),$(e[0]),je(e[0].value)}function Au(e){return s(e.length,1),$(e[0]),S([...e[0].value.values()])}function fu(e){s(e.length,1);let t=e[0];if(L(t))return a(0);if(E(e[0]))return a(e[0].value.size);if(j(e[0]))return a(e[0].value.length);throw new TypeError("Invalid argument type")}var as=[["Math.abs",hu],["Math.acos",vu],["Math.acosh",gu],["Math.asin",xu],["Math.asinh",bu],["Math.atan",Cu],["Math.atan2",Su],["Math.atanh",Eu],["Math.cbrt",wu],["Math.ceil",Tu],["Math.clz32",Mu],["Math.cos",Du],["Math.cosh",Pu],["Math.exp",Vu],["Math.expm1",Fu],["Math.floor",Lu],["Math.fround",ku],["Math.hypot",Iu],["Math.imul",Ru],["Math.log",qu],["Math.log10",Bu],["Math.log1p",Uu],["Math.log2",$u],["Math.max",Ou],["Math.min",Ku],["Math.pow",Gu],["Math.random",Wu],["Math.round",ju],["Math.sign",Hu],["Math.sin",Qu],["Math.sinh",_u],["Math.sqrt",zu],["Math.tan",Ju],["Math.tanh",Yu],["Math.trunc",Xu],["Math.E",Zu],["Math.LN10",ep],["Math.LN2",tp],["Math.LOG10E",op],["Math.LOG2E",sp],["Math.PI",np],["Math.SQRT1_2",rp],["Math.SQRT2",up]];function hu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.abs(t);return y(o)}function vu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.acos(t);return y(o)}function gu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.acosh(t);return y(o)}function xu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.asin(t);return y(o)}function bu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.asinh(t);return y(o)}function Cu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.atan(t);return y(o)}function Su(e){s(e.length,2),p(e[0]),p(e[1]);let t=e[0].value,o=e[1].value,n=Math.atan2(t,o);return y(n)}function Eu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.atanh(t);return y(o)}function wu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.cbrt(t);return y(o)}function Tu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.ceil(t);return y(o)}function Mu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.clz32(t);return y(o)}function Du(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.cos(t);return y(o)}function Pu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.cosh(t);return y(o)}function Vu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.exp(t);return y(o)}function Fu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.expm1(t);return y(o)}function Lu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.floor(t);return y(o)}function ku(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.fround(t);return y(o)}function Iu(e){te(e,re);let t=e.map(de),o=Math.hypot(...t);return y(o)}function Ru(e){s(e.length,2),p(e[0]),p(e[1]);let t=e[0].value,o=e[1].value,n=Math.imul(t,o);return y(n)}function qu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.log(t);return y(o)}function Bu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.log10(t);return y(o)}function Uu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.log1p(t);return y(o)}function $u(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.log2(t);return y(o)}function Ou(e){te(e,re);let t=e.map(de),o=Math.max(...t);return y(o)}function Ku(e){te(e,re);let t=e.map(de),o=Math.min(...t);return y(o)}function Gu(e){if(e.length===2&&x(e[0])&&x(e[1])){let t=e[0].value,o=e[1].value,n=t**o;return y(n)}throw new TypeError('Invalid arguments to "Math.pow"')}function Wu(e){if(e.length===0){let t=Math.random();return y(t)}throw new TypeError('Invalid arguments to "Math.random"')}function ju(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.round(t);return y(o)}function Hu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.sign(t);return y(o)}function Qu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.sin(t);return y(o)}function _u(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.sinh(t);return y(o)}function zu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.sqrt(t);return y(o)}function Ju(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.tan(t);return y(o)}function Yu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.tanh(t);return y(o)}function Xu(e){s(e.length,1),p(e[0]);let t=e[0].value,o=Math.trunc(t);return y(o)}function Zu(e){if(e.length===0)return y(Math.E);throw new TypeError('Invalid arguments to "Math.E"')}function ep(e){if(e.length===0)return y(Math.LN10);throw new TypeError('Invalid arguments to "Math.LN10"')}function tp(e){if(e.length===0)return y(Math.LN2);throw new TypeError('Invalid arguments to "Math.LN2"')}function op(e){if(e.length===0)return y(Math.LOG10E);throw new TypeError('Invalid arguments to "Math.LOG10E"')}function sp(e){if(e.length===0)return y(Math.LOG2E);throw new TypeError('Invalid arguments to "Math.LOG2E"')}function np(e){if(e.length===0)return y(Math.PI);throw new TypeError('Invalid arguments to "Math.PI"')}function rp(e){if(e.length===0)return y(Math.SQRT1_2);throw new TypeError('Invalid arguments to "Math.SQRT1_2"')}function up(e){if(e.length===0)return y(Math.SQRT2);throw new TypeError('Invalid arguments to "Math.SQRT2"')}var ds=[["Number",pp],["Number.isFinite",ip],["Number.isInteger",yp],["Number.isNaN",ap],["Number.isSafeInteger",dp],["Number.parseFloat",lp],["Number.parseInt",cp],["Number.prototype.toExponential",bp],["Number.prototype.toFixed",Cp],["Number.prototype.toPrecision",Sp],["Number.prototype.toString",Ep],["Number.EPSILON",Np],["Number.MAX_SAFE_INTEGER",mp],["Number.MAX_VALUE",Ap],["Number.MIN_SAFE_INTEGER",fp],["Number.MIN_VALUE",hp],["Number.NaN",vp],["Number.NEGATIVE_INFINITY",gp],["Number.POSITIVE_INFINITY",xp]];function pp(e){if(e.length===1&&b(e[0])){let t=e[0].value,o=Number(t);return y(o)}throw new TypeError('Invalid arguments to "Number"')}function ip(e){if(e.length===1&&b(e[0])){let t=e[0].value,o=Number.isFinite(t);return y(o)}throw new TypeError('Invalid arguments to "Number.isFinite"')}function yp(e){if(e.length===1&&b(e[0])){let t=e[0].value,o=Number.isInteger(t);return y(o)}throw new TypeError('Invalid arguments to "Number.isInteger"')}function ap(e){if(e.length===1&&b(e[0])){let t=e[0].value,o=Number.isNaN(t);return y(o)}throw new TypeError('Invalid arguments to "Number.isNaN"')}function dp(e){if(e.length===1&&b(e[0])){let t=e[0].value,o=Number.isSafeInteger(t);return y(o)}throw new TypeError('Invalid arguments to "Number.isSafeInteger"')}function lp(e){s(e.length,1),d(e[0]);let t=Se(e[0]),o=Number.parseFloat(t);return y(o)}function cp(e){h(e.length,1,2),d(e[0]);let t=e[0].value;if(e.length===2){p(e[1]);let n=e[1].value,u=Number.parseInt(t,n);return a(u)}let o=Number.parseInt(t);return a(o)}function Np(e){if(e.length===0){let t=Number.EPSILON;return y(t)}throw new TypeError('Invalid arguments to "Number.EPSILON"')}function mp(e){if(e.length===0){let t=Number.MAX_SAFE_INTEGER;return y(t)}throw new TypeError('Invalid arguments to "Number.MAX_SAFE_INTEGER"')}function Ap(e){if(e.length===0){let t=Number.MAX_VALUE;return y(t)}throw new TypeError('Invalid arguments to "Number.MAX_VALUE"')}function fp(e){if(e.length===0){let t=Number.MIN_SAFE_INTEGER;return y(t)}throw new TypeError('Invalid arguments to "Number.MIN_SAFE_INTEGER"')}function hp(e){if(e.length===0){let t=Number.MIN_VALUE;return y(t)}throw new TypeError('Invalid arguments to "Number.MIN_VALUE"')}function vp(e){if(e.length===0){let t=Number.NaN;return y(t)}throw new TypeError('Invalid arguments to "Number.NaN"')}function gp(e){if(e.length===0){let t=Number.NEGATIVE_INFINITY;return y(t)}throw new TypeError('Invalid arguments to "Number.NEGATIVE_INFINITY"')}function xp(e){if(e.length===0){let t=Number.POSITIVE_INFINITY;return y(t)}throw new TypeError('Invalid arguments to "Number.POSITIVE_INFINITY"')}function bp(e){if(h(e.length,1,2),p(e[0]),e.length===2){p(e[1]);let o=e[1].value,n=e[0].value.toExponential(o);return c(n)}let t=e[0].value.toExponential();return c(t)}function Cp(e){if(h(e.length,1,2),p(e[0]),e.length===2){p(e[1]);let o=e[1].value,n=e[0].value.toFixed(o);return c(n)}let t=e[0].value.toFixed();return c(t)}function Sp(e){if(h(e.length,1,2),p(e[0]),e.length===2){p(e[1]);let o=e[1].value,n=e[0].value.toPrecision(o);return c(n)}let t=e[0].value.toPrecision();return c(t)}function Ep(e){if(h(e.length,1,2),p(e[0]),e.length===2){p(e[1]);let o=e[1].value,n=e[0].value.toString(o);return c(n)}let t=e[0].value.toString();return c(t)}var ls=[["typeof",$p],["instanceof",Op],["neq",qp],["nullish",Kp],["power",Gp],["remainder",Mp],["rshift",kp],["lshift",Lp],["rshift-unsigned",Ip],["bit-and",Dp],["bit-or",Pp],["bit-xor",Vp],["bit-not",Fp],["and",wp],["or",Tp],["not",Rp],["increment",Bp],["decrement",Up]];function wp(e){for(let o of e)if(!$e(o,!0))return m(!1);return m(!0)}function Tp(e){for(let t of e)if($e(t))return m(!0);return m(!1)}function Mp([e,t]){if(x(e)&&x(t))return a((e.value%t.value+t.value)%t.value);throw new TypeError("not a number")}function Dp([e,t]){if(x(e)&&x(t))return a(e.value&t.value);throw new TypeError("not a number")}function Pp([e,t]){if(x(e)&&x(t))return a(e.value|t.value);throw new TypeError("not a number")}function Vp([e,t]){if(x(e)&&x(t))return a(e.value^t.value);throw new TypeError("not a number")}function Fp([e]){if(x(e))return a(~e.value);throw new TypeError("not a number")}function Lp([e,t]){if(x(e)&&x(t))return a(e.value<<t.value);throw new TypeError("not a number")}function kp([e,t]){if(x(e)&&x(t))return a(e.value>>t.value);throw new TypeError("not a number")}function Ip([e,t]){if(x(e)&&x(t))return a(e.value>>>t.value);throw new TypeError("not a number")}function Rp([e]){return m(!e.value)}function qp(e){s(e.length,2);let t=oe(e[0],e[1]);return m(!t.value)}function Bp(e){h(e.length,1,2),p(e[0]);let t="postfix";if(e[1]!==void 0){if(d(e[1]),e[1].value!=="prefix"&&e[1].value!=="postfix")throw new TypeError(`Invalid affix ${String(e[1].value)}. The affix must be "prefix" or "postfix"`);t=e[1].value}if(t==="postfix")return A([a(e[0].value+1),a(e[0].value)]);if(t==="prefix")return A([a(e[0].value+1),a(e[0].value+1)]);throw new Error("Unhandled error in decrement")}function Up(e){h(e.length,1,2),p(e[0]);let t="postfix";if(e[1]!==void 0){if(d(e[1]),e[1].value!=="prefix"&&e[1].value!=="postfix")throw new TypeError(`Invalid affix ${String(e[1].value)}. The affix must be "prefix" or "postfix"`);t=e[1].value}if(t==="postfix")return A([a(e[0].value-1),a(e[0].value)]);if(t==="prefix")return A([a(e[0].value-1),a(e[0].value-1)]);throw new Error("Unhandled error in decrement")}function $p(e){s(e.length,2),f(e[0]),d(e[1]);let t=typeof e[0].value;if(t!=="bigint"&&t!=="boolean"&&t!=="function"&&t!=="number"&&t!=="object"&&t!=="string"&&t!=="symbol"&&t!=="undefined")throw new Error(`Invalid type: "${e[1].value}". Type must be one of bigint, boolean, function, number, object, string, symbol, or undefined`);return m(t===e[1].value)}function Op(e){s(e.length,2),f(e[0]),d(e[1]);let t=e[0],o=e[1].value,n;if(o==="AstNode"||o==="AtomNode"||o==="BooleanNode"||o==="ErrorNode"||o==="FunctionNode"||o==="KeywordNode"||o==="ListNode"||o==="MapNode"||o==="NilNode"||o==="NumberNode"||o==="StringNode"||o==="SymbolNode"||o==="VectorNode")n=P[e[1].value];else if(Object.hasOwn(globalThis,e[1].value))n=globalThis[e[1].value];else throw new TypeError(`Unknown instance: "${e[1].value}"`);return m(t instanceof n)}function Kp([e,t]){return e.value==null?t:e}function Gp([e,t]){if(x(e)&&x(t))return a(e.value**t.value);throw new TypeError("not a number")}var cs=[["RegExp.new",Wp],["RegExp.prototype.exec",jp],["RegExp.prototype.test",Hp]];function Wp(e){h(e.length,1,2),d(e[0]);let t=e[0].value;if(e.length===2){d(e[1]);let n=e[1].value,u=new RegExp(t,n);return q(u)}let o=new RegExp(t);return q(o)}function jp(e){s(e.length,2),M(e[0]);let t=e[0].value;pe(t),d(e[1]);let o=e[1].value,n=t.exec(o);return n?A(n.map(y)):r()}function Hp(e){s(e.length,2),M(e[0]),pe(e[0].value),d(e[1]);let t=e[0].value.test(e[1].value);return m(t)}var As=[["String",Ae.printUnescapedString],["String.fromCharCode",Qp],["String.fromCodePoint",_p],["String::at",Ns],["String::charAt",Ns],["String::charCodeAt",ms],["String::codePointAt",ms],["String::concat",zp],["String::endsWith",Jp],["String::includes",Yp],["String::indexOf",Xp],["String::isWellFormed",Zp],["String::lastIndexOf",ei],["String::length",ti],["String::localeCompare",oi],["String::match",si],["String::matchAll",ni],["String::normalize",ri],["String::padEnd",ui],["String::padStart",pi],["String::repeat",ii],["String::replace",yi],["String::replaceAll",ai],["String::search",di],["String::slice",li],["String::split",ci],["String::startsWith",Ni],["String::toLocaleLowerCase",mi],["String::toLocaleUpperCase",Ai],["String::toLowerCase",fi],["String::toUpperCase",hi],["String::toWellFormed",vi],["String::trim",gi],["String::trimEnd",xi],["String::trimStart",bi],["String.raw",Ci]];function Qp(e){s(e.length,1),g(e[0]),te(e[0].value,re);let t=e[0].value.map(de),o=String.fromCharCode(...t);return c(o)}function _p(e){te(e,re);let t=e.map(de),o=String.fromCodePoint(...t);return c(o)}function Ns(e){s(e.length,2),d(e[0]),p(e[1]);let t=String.prototype.at.call(e[0].value,e[1].value);return t===void 0?r():c(t)}function ms(e){s(e.length,2),d(e[0]),p(e[1]);let t=String.prototype.codePointAt.call(e[0].value,e[1].value);return t===void 0?r():a(t)}function zp(e){D(e.length,2),te(e,ce);let t=e[0].value,o=e.slice(1).map(Se),n=String.prototype.concat.call(t,...o);return c(n)}function Jp(e){h(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.endsWith.call(t,o,n);return y(u)}function Yp(e){h(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.includes.call(t,o,n);return y(u)}function Xp(e){h(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.indexOf.call(t,o,n);return y(u)}function Zp(e){s(e.length,1),d(e[0]);let t=e[0].value,o=String.prototype.isWellFormed.call(t);return y(o)}function ei(e){h(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.lastIndexOf.call(t,o,n);return y(u)}function ti(e){s(e.length,1),f(e[0]);let o=e[0].value.length;return y(o)}function oi(e){h(e.length,2,4),d(e[0]),d(e[1]);let t=e[0].value,o=e[1].value,n,u;if(e.length>2){let l=e[2];w(l)?n=l.value:I(l)?(te(l.value,ce),n=l.value.map(Se)):(st(l),n=void 0)}if(e.length>3){let l=e[3];$(l),u=Qe(l)}let i=String.prototype.localeCompare.call(t,o,n,u);return y(i)}function si(e){s(e.length,2),d(e[0]),M(e[1]),pe(e[1].value);let t=e[0].value,o=e[1].value,n=String.prototype.match.call(t,o);return y(n)}function ni(e){s(e.length,2),d(e[0]),M(e[1]),pe(e[1].value);let t=e[0].value,o=e[1].value,n=String.prototype.matchAll.call(t,o);return y(n)}function ri(e){h(e.length,1,2),f(e[0]),e.length===2&&d(e[1]);let t=e[0].value,o=e.length===2?e[1].value:void 0,n=String.prototype.normalize.call(t,o);return y(n)}function ui(e){h(e.length,2,3),f(e[0]),p(e[1]),e.length===3&&d(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.padEnd.call(t,o,n);return y(u)}function pi(e){h(e.length,2,3),f(e[0]),p(e[1]),e.length===3&&d(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=String.prototype.padStart.call(t,o,n);return y(u)}function ii(e){s(e.length,2),d(e[0]),p(e[1]);let t=e[0].value,o=e[1].value,n=String.prototype.repeat.call(t,o);return y(n)}function yi(e){s(e.length,3),d(e[0]);let t="";w(e[1])||(M(e[1]),pe(e[1].value)),t=e[1].value;let o;if(w(e[2]))o=e[2].value;else throw new Error("Function replacers are not implemented for String.prototype.replace");let u=e[0].value.replace(t,o);return y(u)}function ai(e){s(e.length,3),d(e[0]);let t="";w(e[1])||(M(e[1]),pe(e[1].value)),t=e[1].value;let o;if(w(e[2]))o=e[2].value;else throw new Error("Function replacers are not implemented for String.prototype.replaceAll");let u=e[0].value.replaceAll(t,o);return y(u)}function di(e){s(e.length,2),d(e[0]),M(e[1]),pe(e[1].value);let t=e[0].value,o=e[1].value,n=String.prototype.search.call(t,o);return y(n)}function li(e){h(e.length,1,3),f(e[0]),e.length>1&&p(e[1]),e.length>2&&p(e[2]);let t=e[0].value,o=e.length>1?e[1].value:void 0,n=e.length>2?e[2].value:void 0,u=String.prototype.slice.call(t,o,n);return y(u)}function ci(e){h(e.length,2,3),d(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length===3?e[2].value:void 0,u=t.split(o,n);return y(u)}function Ni(e){h(e.length,2,3),f(e[0]),d(e[1]),e.length===3&&p(e[2]);let t=e[0].value,o=e[1].value,n=e.length>2?e[2].value:void 0,u=String.prototype.startsWith.call(t,o,n);return y(u)}function mi(e){h(e.length,1,2),f(e[0]),e.length===2&&(L(e[1])||d(e[1]));let t=e[0].value,o=e.length===2&&!L(e[1])?e[1].value:void 0,n=String.prototype.toLocaleLowerCase.call(t,o);return y(n)}function Ai(e){h(e.length,1,2),f(e[0]),e.length===2&&(L(e[1])||d(e[1]));let t=e[0].value,o=e.length===2&&!L(e[1])?e[1].value:void 0,n=String.prototype.toLocaleUpperCase.call(t,o);return y(n)}function fi(e){s(e.length,1),f(e[0]);let t=e[0].value,o=String.prototype.toLowerCase.call(t);return y(o)}function hi(e){s(e.length,1),f(e[0]);let t=e[0].value,o=String.prototype.toUpperCase.call(t);return y(o)}function vi(e){s(e.length,1),f(e[0]);let t=e[0].value,o=String.prototype.toWellFormed.call(t);return y(o)}function gi(e){s(e.length,1),f(e[0]);let t=e[0].value,o=String.prototype.trim.call(t);return y(o)}function xi(e){s(e.length,1),f(e[0]);let t=e[0].value,o=String.prototype.trimEnd.call(t);return y(o)}function bi(e){s(e.length,1),f(e[0]);let t=e[0].value,o=String.prototype.trimStart.call(t);return y(o)}function Ci(e){s(e.length,2),$(e[0]),g(e[1]);let t=Qe(e[0]),o=e[1].value,n=String.raw(t,...o);return y(n)}var fs=[["Symbol",Si],["Symbol.for",Ei],["Symbol.keyFor",wi]];function Si(e){h(e.length,0,1),e.length===1&&d(e[0]);let t=e.length===1?e[0].value:void 0,o=Symbol(t);return q(o)}function Ei(e){s(e.length,1),d(e[0]);let t=e[0].value,o=Symbol.for(t);return q(o)}function wi(e){s(e.length,1),M(e[0]),nt(e[0].value);let t=e[0].value,o=Symbol.keyFor(t);return o?c(o):r()}var Ti=[...ts,...os,...ss,...ls,...ns,...rs,...ps,...is,...as,...ds,...cs,...As,...fs],_e=new Map;for(let[e,t]of Ti)if(_e.set(C(e),k(t)),e.includes(".prototype.")){let o=e.replace(".prototype.","::");_e.set(C(o),k(t))}else if(e.includes(".prototype[")){let o=e.replace(".prototype[","::[");_e.set(C(o),k(t))}var lt=new Map,Di=[["add-event-listener",Cl],["prevent-default",xs],["get-element-by-id",Pi],["query-selector",Vi],["set-attribute",gs],["get-attribute",hs],["CustomEvent::new",Fi],["CustomEvent::prototype",Li],["CustomEvent.detail",ki],["CustomEvent::initCustomEvent",Ii],["Document::addEventListener",Ss],["Document::adoptNode",qy],["Document::captureEvents",By],["Document::caretPositionFromPoint",Uy],["Document::caretRangeFromPoint",$y],["Document::clear",Oy],["Document::close",Ky],["Document::createAttribute",Gy],["Document::createAttributeNS",Wy],["Document::createCDATASection",jy],["Document::createComment",Hy],["Document::createDocumentFragment",Qy],["Document::createElement",_y],["Document::createElementNS",zy],["Document::createEvent",Jy],["Document::createNodeIterator",Yy],["Document::createProcessingInstruction",Xy],["Document::createRange",Zy],["Document::createTextNode",ea],["Document::createTreeWalker",ta],["Document::execCommand",oa],["Document::exitFullscreen",sa],["Document::exitPictureInPicture",na],["Document::exitPointerLock",ra],["Document::getElementById",bs],["Document::getElementsByClassName",ua],["Document::getElementsByName",pa],["Document::getElementsByTagName",ia],["Document::getElementsByTagNameNS",ya],["Document::getSelection",aa],["Document::hasFocus",da],["Document::hasStorageAccess",la],["Document::importNode",ca],["Document::new",Ri],["Document::open",Na],["Document::parseHTMLUnsafe",Bi],["Document::prototype",qi],["Document::queryCommandEnabled",ma],["Document::queryCommandIndeterm",Aa],["Document::queryCommandState",fa],["Document::queryCommandSupported",ha],["Document::queryCommandValue",va],["Document::querySelector",Cs],["Document::releaseEvents",ga],["Document::removeEventListener",Ea],["Document::requestStorageAccess",xa],["Document::startViewTransition",ba],["Document::write",Ca],["Document::writeln",Sa],["Document.alinkColor",$i],["Document.all",Oi],["Document.anchors",Ki],["Document.applets",Gi],["Document.bgColor",Wi],["Document.body",ji],["Document.characterSet",Hi],["Document.charset",Qi],["Document.compatMode",_i],["Document.contentType",zi],["Document.cookie",Ji],["Document.currentScript",Yi],["Document.defaultView",Xi],["Document.designMode",Zi],["Document.dir",ey],["Document.doctype",ty],["Document.documentElement",oy],["Document.documentURI",sy],["Document.domain",ny],["Document.embeds",ry],["Document.fgColor",uy],["Document.forms",py],["Document.fragmentDirective",iy],["Document.fullscreen",yy],["Document.fullscreenEnabled",ay],["Document.head",dy],["Document.hidden",ly],["Document.images",cy],["Document.implementation",Ny],["Document.inputEncoding",my],["Document.lastModified",Ay],["Document.linkColor",fy],["Document.links",hy],["Document.onfullscreenchange",vy],["Document.onfullscreenerror",gy],["Document.onpointerlockchange",xy],["Document.onpointerlockerror",by],["Document.onreadystatechange",Cy],["Document.onvisibilitychange",Sy],["Document.ownerDocument",Ey],["Document.pictureInPictureEnabled",wy],["Document.plugins",Ty],["Document.readyState",My],["Document.referrer",Dy],["Document.rootElement",Py],["Document.scripts",Vy],["Document.scrollingElement",Fy],["Document.timeline",Ly],["Document.title",ky],["Document.URL",Ui],["Document.visibilityState",Iy],["Document.vlinkColor",Ry],["DocumentFragment::getElementById",ws],["DocumentFragment::new",Fa],["DocumentFragment::prototype",La],["DocumentFragment.ownerDocument",ka],["DocumentFragment::querySelector",Es],["DocumentTimeline::new",wa],["DocumentTimeline::prototype",Ta],["DocumentType::new",Ia],["DocumentType::prototype",Ra],["DocumentType.name",Ma],["DocumentType.ownerDocument",Da],["DocumentType.publicId",Pa],["DocumentType.systemId",Va],["Element::addEventListener",Ms],["Element::attachShadow",ad],["Element::checkVisibility",dd],["Element::closest",ld],["Element::computedStyleMap",cd],["Element::getAttribute",hs],["Element::getAttributeNames",Nd],["Element::getAttributeNode",md],["Element::getAttributeNodeNS",vs],["Element::getAttributeNS",vs],["Element::getBoundingClientRect",Ad],["Element::getClientRects",fd],["Element::getElementsByClassName",hd],["Element::getElementsByTagName",vd],["Element::getElementsByTagNameNS",gd],["Element::getHTML",xd],["Element::hasAttribute",bd],["Element::hasAttributeNS",Cd],["Element::hasAttributes",Sd],["Element::hasPointerCapture",Ed],["Element::insertAdjacentElement",wd],["Element::insertAdjacentHTML",Td],["Element::insertAdjacentText",Md],["Element::matches",Dd],["Element::new",qa],["Element::prototype",Ba],["Element::querySelector",Ts],["Element::releasePointerCapture",Pd],["Element::removeAttribute",Vd],["Element::removeAttributeNode",Ld],["Element::removeAttributeNS",Fd],["Element::removeEventListener",Qd],["Element::requestFullscreen",kd],["Element::requestPointerLock",Id],["Element::scroll",Rd],["Element::scrollBy",qd],["Element::scrollIntoView",Bd],["Element::scrollTo",Ud],["Element::setAttribute",gs],["Element::setAttributeNode",Od],["Element::setAttributeNodeNS",Kd],["Element::setAttributeNS",$d],["Element::setHTMLUnsafe",Gd],["Element::setPointerCapture",Wd],["Element::toggleAttribute",jd],["Element::webkitMatchesSelector",Hd],["Element.attributes",Ua],["Element.classList",$a],["Element.className",Oa],["Element.clientHeight",Ka],["Element.clientLeft",Ga],["Element.clientTop",Wa],["Element.clientWidth",ja],["Element.currentCSSZoom",Ha],["Element.id",Qa],["Element.innerHTML",_a],["Element.localName",za],["Element.namespaceURI",Ja],["Element.onfullscreenchange",Ya],["Element.onfullscreenerror",Xa],["Element.outerHTML",Za],["Element.ownerDocument",ed],["Element.part",td],["Element.prefix",od],["Element.scrollHeight",sd],["Element.scrollLeft",nd],["Element.scrollTop",rd],["Element.scrollWidth",ud],["Element.shadowRoot",pd],["Element.slot",id],["Element.tagName",yd],["Event::AT_TARGET",Xd],["Event::BUBBLING_PHASE",Zd],["Event::CAPTURING_PHASE",Yd],["Event::composedPath",fl],["Event::initEvent",hl],["Event::new",_d],["Event::NONE",Jd],["Event::preventDefault",xs],["Event::prototype",zd],["Event::stopImmediatePropagation",vl],["Event::stopPropagation",gl],["Event.AT_TARGET",ml],["Event.bubbles",el],["Event.BUBBLING_PHASE",Al],["Event.cancelable",ol],["Event.cancelBubble",tl],["Event.CAPTURING_PHASE",Nl],["Event.composed",sl],["Event.currentTarget",nl],["Event.defaultPrevented",rl],["Event.eventPhase",ul],["Event.isTrusted",pl],["Event.NONE",cl],["Event.returnValue",il],["Event.srcElement",yl],["Event.target",al],["Event.timeStamp",dl],["Event.type",ll],["EventTarget::new",xl],["EventTarget::prototype",bl],["EventTarget::addEventListener",Ds],["EventTarget::dispatchEvent",Sl],["EventTarget::removeEventListener",El]];for(let[e,t]of Di)lt.set(C(e),k(t));function Pi(e){return h(e.length,1,2),e[0].value instanceof DocumentFragment?ws(e):bs(e)}function Vi(e){if(h(e.length,1,2),e.length===1&&e[0].value instanceof Document)return Cs(e);if(M(e[0]),e.length===2&&e[0].value instanceof DocumentFragment)return Es(e);if(e.length===2&&e[0].value instanceof Element)return Ts(e);throw N("querySelector expects a Document, DocumentFragment or Element as the first parameter.","TypeError",e[0])}function Fi(e){return s(e.length,1),r()}function Li(e){return s(e.length,1),r()}function ki(e){return s(e.length,1),r()}function Ii(e){return s(e.length,1),r()}function Ri(e){return s(e.length,1),r()}function qi(e){return s(e.length,1),r()}function Bi(e){return s(e.length,1),r()}function Ui(e){return s(e.length,1),r()}function $i(e){return s(e.length,1),r()}function Oi(e){return s(e.length,1),r()}function Ki(e){return s(e.length,1),r()}function Gi(e){return s(e.length,1),r()}function Wi(e){return s(e.length,1),r()}function ji(e){return s(e.length,1),r()}function Hi(e){return s(e.length,1),r()}function Qi(e){return s(e.length,1),r()}function _i(e){return s(e.length,1),r()}function zi(e){return s(e.length,1),r()}function Ji(e){return s(e.length,1),r()}function Yi(e){return s(e.length,1),r()}function Xi(e){return s(e.length,1),r()}function Zi(e){return s(e.length,1),r()}function ey(e){return s(e.length,1),r()}function ty(e){return s(e.length,1),r()}function oy(e){return s(e.length,1),r()}function sy(e){return s(e.length,1),r()}function ny(e){return s(e.length,1),r()}function ry(e){return s(e.length,1),r()}function uy(e){return s(e.length,1),r()}function py(e){return s(e.length,1),r()}function iy(e){return s(e.length,1),r()}function yy(e){return s(e.length,1),r()}function ay(e){return s(e.length,1),r()}function dy(e){return s(e.length,1),r()}function ly(e){return s(e.length,1),r()}function cy(e){return s(e.length,1),r()}function Ny(e){return s(e.length,1),r()}function my(e){return s(e.length,1),r()}function Ay(e){return s(e.length,1),r()}function fy(e){return s(e.length,1),r()}function hy(e){return s(e.length,1),r()}function vy(e){return s(e.length,1),r()}function gy(e){return s(e.length,1),r()}function xy(e){return s(e.length,1),r()}function by(e){return s(e.length,1),r()}function Cy(e){return s(e.length,1),r()}function Sy(e){return s(e.length,1),r()}function Ey(e){return s(e.length,1),r()}function wy(e){return s(e.length,1),r()}function Ty(e){return s(e.length,1),r()}function My(e){return s(e.length,1),r()}function Dy(e){return s(e.length,1),r()}function Py(e){return s(e.length,1),r()}function Vy(e){return s(e.length,1),r()}function Fy(e){return s(e.length,1),r()}function Ly(e){return s(e.length,1),r()}function ky(e){return s(e.length,1),r()}function Iy(e){return s(e.length,1),r()}function Ry(e){return s(e.length,1),r()}function qy(e){return s(e.length,1),r()}function By(e){return s(e.length,1),r()}function Uy(e){return s(e.length,1),r()}function $y(e){return s(e.length,1),r()}function Oy(e){return s(e.length,1),r()}function Ky(e){return s(e.length,1),r()}function Gy(e){return s(e.length,1),r()}function Wy(e){return s(e.length,1),r()}function jy(e){return s(e.length,1),r()}function Hy(e){return s(e.length,1),r()}function Qy(e){return s(e.length,1),r()}function _y(e){return s(e.length,1),r()}function zy(e){return s(e.length,1),r()}function Jy(e){return s(e.length,1),r()}function Yy(e){return s(e.length,1),r()}function Xy(e){return s(e.length,1),r()}function Zy(e){return s(e.length,1),r()}function ea(e){return s(e.length,1),r()}function ta(e){return s(e.length,1),r()}function oa(e){return s(e.length,1),r()}function sa(e){return s(e.length,1),r()}function na(e){return s(e.length,1),r()}function ra(e){return s(e.length,1),r()}function bs(e){s(e.length,1),d(e[0]);let t=Document.prototype.getElementById.call(document,e[0].value);return t?q(t):r()}function ua(e){return s(e.length,1),r()}function pa(e){return s(e.length,1),r()}function ia(e){return s(e.length,1),r()}function ya(e){return s(e.length,1),r()}function aa(e){return s(e.length,1),r()}function da(e){return s(e.length,1),r()}function la(e){return s(e.length,1),r()}function ca(e){return s(e.length,1),r()}function Na(e){return s(e.length,1),r()}function ma(e){return s(e.length,1),r()}function Aa(e){return s(e.length,1),r()}function fa(e){return s(e.length,1),r()}function ha(e){return s(e.length,1),r()}function va(e){return s(e.length,1),r()}function Cs(e){s(e.length,1),d(e[0]);let t=Document.prototype.querySelector.call(document,e[0].value);return t?q(t):r()}function ga(e){return s(e.length,1),r()}function xa(e){return s(e.length,1),r()}function ba(e){return s(e.length,1),r()}function Ca(e){return s(e.length,1),r()}function Sa(e){return s(e.length,1),r()}function Ss(e){return s(e.length,2),d(e[0]),T(e[1]),Document.prototype.addEventListener.call(document,e[0].value,t=>{e[1].value(q(t))}),r()}function Ea(e){return s(e.length,1),r()}function wa(e){return s(e.length,1),r()}function Ta(e){return s(e.length,1),r()}function Ma(e){return s(e.length,1),r()}function Da(e){return s(e.length,1),r()}function Pa(e){return s(e.length,1),r()}function Va(e){return s(e.length,1),r()}function Fa(e){return s(e.length,1),r()}function La(e){return s(e.length,1),r()}function Es(e){if(s(e.length,2),M(e[0]),d(e[1]),!(e[0].value instanceof DocumentFragment))throw N("querySelector expects a DocumentFragment as the first parameter.","TypeError",e[0]);let t=DocumentFragment.prototype.querySelector.call(e[0].value,e[1].value);return t?q(t):r()}function ka(e){return s(e.length,1),r()}function ws(e){s(e.length,1),d(e[0]),M(e[1]);let t=DocumentFragment.prototype.getElementById.call(e[0].value,e[1].value);return t?q(t):r()}function Ia(e){return s(e.length,1),r()}function Ra(e){return s(e.length,1),r()}function qa(e){return s(e.length,1),r()}function Ba(e){return s(e.length,1),r()}function Ts(e){if(s(e.length,2),M(e[0]),d(e[1]),!(e[0].value instanceof Element))throw N("querySelector expects an Element as the first parameter.","TypeError",e[0]);let t=Element.prototype.querySelector.call(e[0].value,e[1].value);return t?q(t):r()}function Ua(e){return s(e.length,1),r()}function $a(e){return s(e.length,1),r()}function Oa(e){return s(e.length,1),r()}function Ka(e){return s(e.length,1),r()}function Ga(e){return s(e.length,1),r()}function Wa(e){return s(e.length,1),r()}function ja(e){return s(e.length,1),r()}function Ha(e){return s(e.length,1),r()}function Qa(e){return s(e.length,1),r()}function _a(e){return s(e.length,1),r()}function za(e){return s(e.length,1),r()}function Ja(e){return s(e.length,1),r()}function Ya(e){return s(e.length,1),r()}function Xa(e){return s(e.length,1),r()}function Za(e){return s(e.length,1),r()}function ed(e){return s(e.length,1),r()}function td(e){return s(e.length,1),r()}function od(e){return s(e.length,1),r()}function sd(e){return s(e.length,1),r()}function nd(e){return s(e.length,1),r()}function rd(e){return s(e.length,1),r()}function ud(e){return s(e.length,1),r()}function pd(e){return s(e.length,1),r()}function id(e){return s(e.length,1),r()}function yd(e){return s(e.length,1),r()}function ad(e){return s(e.length,1),r()}function dd(e){return s(e.length,1),r()}function ld(e){return s(e.length,1),r()}function cd(e){return s(e.length,1),r()}function hs(e){s(e.length,2),M(e[0]),d(e[1]);let t=Element.prototype.getAttribute.call(e[0].value,e[1].value);return t?c(t):r()}function Nd(e){return s(e.length,1),r()}function md(e){return s(e.length,1),r()}function vs(e){return s(e.length,1),r()}function Ad(e){return s(e.length,1),r()}function fd(e){return s(e.length,1),r()}function hd(e){return s(e.length,1),r()}function vd(e){return s(e.length,1),r()}function gd(e){return s(e.length,1),r()}function xd(e){return s(e.length,1),r()}function bd(e){return s(e.length,1),r()}function Cd(e){return s(e.length,1),r()}function Sd(e){return s(e.length,1),r()}function Ed(e){return s(e.length,1),r()}function wd(e){return s(e.length,1),r()}function Td(e){return s(e.length,1),r()}function Md(e){return s(e.length,1),r()}function Dd(e){return s(e.length,1),r()}function Pd(e){return s(e.length,1),r()}function Vd(e){return s(e.length,1),r()}function Fd(e){return s(e.length,1),r()}function Ld(e){return s(e.length,1),r()}function kd(e){return s(e.length,1),r()}function Id(e){return s(e.length,1),r()}function Rd(e){return s(e.length,1),r()}function qd(e){return s(e.length,1),r()}function Bd(e){return s(e.length,1),r()}function Ud(e){return s(e.length,1),r()}function gs(e){return s(e.length,3),M(e[0]),d(e[1]),d(e[2]),Element.prototype.setAttribute.call(e[0].value,e[1].value,e[2].value),r()}function $d(e){return s(e.length,1),r()}function Od(e){return s(e.length,1),r()}function Kd(e){return s(e.length,1),r()}function Gd(e){return s(e.length,1),r()}function Wd(e){return s(e.length,1),r()}function jd(e){return s(e.length,1),r()}function Hd(e){return s(e.length,1),r()}function Ms(e){if(s(e.length,3),M(e[0]),d(e[1]),T(e[2]),!(e[0].value instanceof Element))throw N("addEventListener expects an Element as the first parameter.","TypeError",e[0]);return Element.prototype.addEventListener.call(e[0].value,e[1].value,t=>{e[2].value(q(t))}),r()}function Qd(e){return s(e.length,1),r()}function _d(e){return s(e.length,1),r()}function zd(e){return s(e.length,1),r()}function Jd(e){return s(e.length,1),r()}function Yd(e){return s(e.length,1),r()}function Xd(e){return s(e.length,1),r()}function Zd(e){return s(e.length,1),r()}function el(e){return s(e.length,1),r()}function tl(e){return s(e.length,1),r()}function ol(e){return s(e.length,1),r()}function sl(e){return s(e.length,1),r()}function nl(e){return s(e.length,1),r()}function rl(e){return s(e.length,1),r()}function ul(e){return s(e.length,1),r()}function pl(e){return s(e.length,1),r()}function il(e){return s(e.length,1),r()}function yl(e){return s(e.length,1),r()}function al(e){return s(e.length,1),r()}function dl(e){return s(e.length,1),r()}function ll(e){return s(e.length,1),r()}function cl(e){return s(e.length,1),r()}function Nl(e){return s(e.length,1),r()}function ml(e){return s(e.length,1),r()}function Al(e){return s(e.length,1),r()}function fl(e){return s(e.length,1),r()}function hl(e){return s(e.length,1),r()}function xs(e){if(s(e.length,1),M(e[0]),!(e[0].value instanceof Event))throw N("preventDefault expects an Event as the first parameter.","TypeError",e[0]);return Event.prototype.preventDefault.call(e[0].value),r()}function vl(e){return s(e.length,1),r()}function gl(e){return s(e.length,1),r()}function xl(e){return s(e.length,1),r()}function bl(e){return s(e.length,1),r()}function Cl(e){if(h(e.length,2,3),e[0].value instanceof Document)return Ss(e);if(e[0].value instanceof EventTarget)return Ds(e);if(e[0].value instanceof Element)return Ms(e);throw N("addEventListener expects an Document, Element, or EventTarget as the first parameter.","TypeError",e[0])}function Ds(e){if(s(e.length,3),M(e[0]),d(e[1]),T(e[2]),!(e[0].value instanceof EventTarget))throw N("addEventListener expects an EventTarget as the first parameter.","TypeError",e[0]);return EventTarget.prototype.addEventListener.call(e[0].value,e[1].value,t=>{e[2].value(q(t))}),r()}function Sl(e){return s(e.length,1),r()}function El(e){return s(e.length,1),r()}function Tl(e){return et(e)}function Nt(e){if(E(e)||B(e))return S([C("quote"),e]);if(!j(e))return e;if(Je(e,"unquote"))return e.value[1];let n=S([]);for(let u=e.value.length-1;u>=0;u--){let i=e.value[u];n=Je(i,"splice-unquote")?S([C("concat"),i.value[1],n]):S([C("cons"),Nt(i),n])}return I(e)&&(n=S([C("vec"),n])),n}function Ml(e,t){if(!F(e)||!(e.value[0]instanceof le))return!1;let o=e.value[0],n=t.findEnv(o);if(!Te(n))return!1;let u=n.get(o);return K(u)?u.isMacro:!1}function Ps(e,t){let o=e;for(;Ml(o,t);){let n=o,u=n.value[0];o=t.get(u).value(n.value.slice(1))}return o}function ct(e,t){if(B(e))return t.get(e);if(I(e)){let o=e.value.map(n=>X(n,t));return A(o)}if(F(e)){let o=e.value.map(n=>X(n,t));return S(o)}if(E(e)){let o=new Map;for(let[n,u]of e.value.entries())o.set(n,X(u,t));return V(o)}if(ue(e)){let o=e.value,n=Array.from(e.attributes).reduce((i,[l,v])=>i.set(l,X(v,t)),new Map),u=e.children.map(i=>X(i,t));return be(o,n,u)}return e}function X(e,t){for(;;){if(F(e)===!1)return ct(e,t);if(e.value.length===0)return e;if(e=Ps(e,t),F(e)===!1)return ct(e,t);if(e.value.length===0)return e;let o=B(e.value[0])?e.value[0].value:"goto_default_clause",n;switch(o){case"var":case"def!":{n=Pl(e,t);break}case"const":case"let*":{n=Fl(e,t);break}case"quote":{n=kl(e,t);break}case"quasiquoteexpand":{n=Rl(e,t);break}case"quasiquote":{n=Bl(e,t);break}case"defmacro!":{n=$l(e,t);break}case"macroexpand":{n=ae(Ps(e.value[1],t));break}case"try":case"try*":{n=Wl(e,t);break}case"do":{n=Kl(e,t);break}case"if":{n=Hl(e,t);break}case"function":case"fn*":{n=_l(e,t);break}default:n=zl(e,t)}if(n.return)return n.return;e=n.continue.ast,t=n.continue.env}}function Dl(e){Q(e),s(e.value.length,3,e),O(e.value[0]);let t=e.value[0];if(t.value!=="var")throw N("Expected var to be called with the value var. This is a bug.","TypeError",t);G(e.value[1]),f(e.value[2])}function Pl(e,t){Dl(e);let o=e.value[1],n=e.value[2],u=X(n,t);return ae(t.set(o,u))}function Vl(e){Q(e),s(e.value.length,3,e),O(e.value[0]);let t=e.value[0];if(t.value!=="const")throw N("Expected let to be called with let but it wasn't. This is a bug with Ensemble.","TypeError",t);J(e.value[1]),f(e.value[2]),Ce(e.value[1].value.length,e);for(let o=0;o<e.value[1].value.length;o+=2)O(e.value[1].value[o]),f(e.value[1].value[o+1])}function Fl(e,t){Vl(e);let o=e.value[1],n=o.value.length,u=new fe(t);for(let i=0;i<n;i+=2){let l=o.value[i],v=o.value[i+1],R=X(v,u);u.set(l,R)}return Me(e.value[2],u)}function Ll(e){Q(e),s(e.value.length,2,e),O(e.value[0]),me(e.value[0],"quote"),f(e.value[1])}function kl(e,t){return Ll(e),ae(e.value[1])}function Il(e){let t="quasiquoteexpand";Q(e),s(e.value.length,2),O(e.value[0]),me(e.value[0],t),f(e.value[1])}function Rl(e,t){return Il(e),ae(Nt(e.value[1]))}function ql(e){let t="quasiquote";Q(e),s(e.value.length,2),O(e.value[0]),me(e.value[0],t),f(e.value[1])}function Bl(e,t){ql(e);let o=Nt(e.value[1]);return Me(o,t)}function Ul(e){let t="defmacro!";Q(e),s(e.value.length,3),O(e.value[0]),me(e.value[0],t),G(e.value[1]),f(e.value[2])}function $l(e,t){Ul(e);let o=e.value[1],n=e.value[2],u=X(n,t),i=H(u);return K(i)&&(i.isMacro=!0),ae(t.set(o,i))}function Ol(e){let t="do";Q(e),D(e.value.length,1),O(e.value[0]),me(e.value[0],t);for(let o of e.value.slice(1))f(o)}function Kl(e,t){Ol(e);let o=r();for(let n=1;n<e.value.length;n++)o=X(e.value[n],t);return{continue:{ast:o,env:t},return:void 0}}function Gl(e){Q(e),h(e.value.length,2,3);let t=e.value[0];if(O(t),t.value!=="try")throw N("Expected try/catch to be called with try. This is a bug.","SyntaxError",t);if(f(e.value[1]),e.value[2]){Q(e.value[2]),s(e.value[2].value.length,3,e.value[2]),O(e.value[2].value[0]);let o=e.value[2].value[0];if(o.value!=="catch")throw N("Expected a catch in the body of a try expression","SyntaxError",o);O(e.value[2].value[1]),f(e.value[2].value[2])}}function Wl(e,t){Gl(e);try{return{return:X(e.value[1],t),continue:void 0}}catch(o){if(!e.value[2])throw o;let n=e.value[2].value[1],u=e.value[2].value[2],i;ee(o)?i=o:o instanceof Error?i=c(o.message):i=c(JSON.stringify(o));let l=N(i),v=new fe(t,[n],[l]);return{return:X(u,v),continue:void 0}}}function jl(e){let t="if";Q(e),h(e.value.length,3,4),O(e.value[0]),me(e.value[0],t),f(e.value[1]),f(e.value[2]),Te(e.value[3])&&f(e.value[3])}function Hl(e,t){jl(e);let o=e.value[1],n=X(o,t);if(n.value!==!1&&n.value!==null){let u=e.value[2];return Me(u,t)}if(e.value[3]!==void 0){let u=e.value[3];return Me(u,t)}return ae(r())}function Ql(e){Q(e),s(e.value.length,3),O(e.value[0]);let t=e.value[0];if(!["fn*","function","=>"].includes(t.value))throw N("Expected function to be called with function but it wasn't. This is a bug with Ensemble.","TypeError",t);J(e.value[1]),te(e.value[1].value,le),f(e.value[2])}function _l(e,t){Ql(e);let o=e.value[1].value,n=e.value[2],u=t,l=k(v=>{let R=new fe(u,o,v);return X(n,R)},{ast:n,env:u,parameters:o});return ae(l)}function zl(e,t){let o=ct(e,t);Q(o);let n=o.value[0];if(K(n)){let u=o.value.slice(1);if(n.closureMeta){let l=n.closureMeta.ast,v=new fe(n.closureMeta.env,n.closureMeta.parameters,u);return{continue:{ast:l,env:v},return:void 0}}return{return:n.value(u),continue:void 0}}return{return:n,continue:void 0}}function Jl(e){return U(e,!0)}function he(e,t){return Jl(X(Tl(e),t))}function Vs(){let e=new fe(void 0);for(let[t,o]of Ae.ns.entries())e.set(t,o);for(let[t,o]of _e.entries())e.set(t,o);for(let[t,o]of tt.entries())e.set(t,o);for(let[t,o]of lt.entries())e.set(t,o);return e.set(C("eval"),k(t=>(s(t.length,1),X(t[0],e)))),e.set(C("dump"),k(t=>e.serialize())),he("(var not (function (a) (if a false true)))",e),he(`(defmacro! cond
			(function (& xs)
				(if (gt (count xs) 0) (list (quote if) (first xs)
															(if (gt (count xs) 1) (nth xs 1)
																	(throw "odd number of forms to cond"))
															(cons (quote cond) (rest (rest xs)))))))`,e),e}var Ls="user> ";function ks(e,t){let o=null;try{o=ie.open(t,"w"),o!==null&&o.puts(e)}catch(n){throw o!==null&&o.close(),new Error(`Error writing to file: ${n}`)}}function mt(e){s(e.length,1);let t=e[0];d(t);let o=Rs(t.value);return o==null?r():c(o)}function Is(e){s(e.length,1),d(e[0]);let t=[],[o,n]=Fs.readdir(e[0].value);if(+n>0)throw new Error(`Error reading directory: ${n}`);for(let u of o)u==="."||u===".."||t.push(c(u));return A(t)}function ot(e){s(e.length,1);let t=e[0];d(t);let o=ie.loadFile(t.value);if(o===null)throw new Error("No such file or directory. xxx");return c(o)}function At(e){s(e.length,2);let t=e[0];d(t);let o=e[1];return d(o),ks(o.value,t.value),r()}function Rs(e=Ls){return ie.out.puts(e),ie.in.getline()?.trim()||null}function*qs(e=Ls){for(;;){ie.out.puts(e);let t=ie.in.getline()?.trim();t&&(yield t)}}function Bs(e){return function(o){s(o.length,1),d(o[0]);let n=ot([o[0]]);return d(n),he(`(do ${n.value})`,e),r()}}function Us(){let e=Vs(),t=Bs(e),o=[["readFile",ot],["slurp",ot],["load-file",t],["import",t],["readln",mt],["prompt",mt],["readir",Is],["spit",At],["writeFile",At]];for(let[n,u]of o)e.set(C(n),k(u));return e}function $s(e=""){return e.replace(/\\/g,"/")}async function Yl(e){let t=Us(),o=e.filter(i=>!i.endsWith("ensemble")&&!i.endsWith("ensemble.exe")),n=o.length>0?$s(o[0]):void 0,u=o.slice(1).map(i=>c(i));if(t.set(C("*ARGV*"),S(u)),t.set(C("*host-language*"),c("Ensemble")),n){he(`(import "${n}")`,t);return}he('(println (str "Welcome to " *host-language* "! Press Ctrl/Cmd+C to exit."))',t);for await(let i of qs("user> "))if(!(i===""||i===null))try{let l=he(i,t);l&&console.log(l)}catch(l){ee(l)?console.log(U(l,!1)):l instanceof Error?console.log(l.message):console.log(String(l))}}var Os={displayPrompt:Rs,initMain:Us,loadFileWithEnv:Bs,main:Yl,readir:Is,readline:qs,readln:mt,rep:he,slurp:ot,spit:At,toPosixPath:$s,writeToFile:ks};Os.main(scriptArgs);
